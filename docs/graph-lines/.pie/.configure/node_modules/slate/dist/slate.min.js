!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("immutable")):"function"==typeof define&&define.amd?define(["exports","immutable"],t):t(e.Slate={},e.Immutable)}(this,function(e,t){"use strict";var r=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)};function n(e){return!0===r(e)&&"[object Object]"===Object.prototype.toString.call(e)}var o=function(e){var t,r;return!1!==n(e)&&("function"==typeof(t=e.constructor)&&(!1!==n(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))},a="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},i=void 0!==a?a:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function s(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}var c=s,l=u;function f(e){if(c===setTimeout)return setTimeout(e,0);if((c===s||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}"function"==typeof i.setTimeout&&(c=setTimeout),"function"==typeof i.clearTimeout&&(l=clearTimeout);var h,d=[],v=!1,y=-1;function p(){v&&h&&(v=!1,h.length?d=h.concat(d):y=-1,d.length&&g())}function g(){if(!v){var e=f(p);v=!0;for(var t=d.length;t;){for(h=d,d=[];++y<t;)h&&h[y].run();y=-1,t=d.length}h=null,v=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===u||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}m.prototype.run=function(){this.fun.apply(null,this.array)};function k(){}var b=k,A=k,O=k,w=k,x=k,T=k,_=k;var B=i.performance||{},N=B.now||B.mozNow||B.msNow||B.oNow||B.webkitNow||function(){return(new Date).getTime()};var F=new Date;var j={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new m(e,t)),1!==d.length||v||f(g)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:b,addListener:A,once:O,off:w,removeListener:x,removeAllListeners:T,emit:_,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*N.call(B),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-F)/1e3}},S=j&&j.env&&j.env.FORBID_DEPRECATIONS,P=void 0!==j&&j.env&&!0,E="undefined"!=typeof console&&"function"==typeof console.log&&"function"==typeof console.warn&&"function"==typeof console.error;function K(e,t){if(P&&E){for(var r,n=arguments.length,o=Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];(r=console)[e].apply(r,[t].concat(o))}}var C={deprecate:function(e,t){if(S)throw new Error("Deprecation ("+e+"): "+t);for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];K.apply(void 0,["warn","Deprecation ("+e+"): "+t].concat(n))},error:function(e){if(E){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=console).error.apply(t,[e].concat(n))}},warn:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];K.apply(void 0,["warn","Warning: "+e].concat(r))}},z={BLOCK:"@@__SLATE_BLOCK__@@",CHANGE:"@@__SLATE_CHANGE__@@",CHARACTER:"@@__SLATE_CHARACTER__@@",DOCUMENT:"@@__SLATE_DOCUMENT__@@",HISTORY:"@@__SLATE_HISTORY__@@",INLINE:"@@__SLATE_INLINE__@@",LEAF:"@@__SLATE_LEAF__@@",MARK:"@@__SLATE_MARK__@@",OPERATION:"@@__SLATE_OPERATION__@@",RANGE:"@@__SLATE_RANGE__@@",SCHEMA:"@@__SLATE_SCHEMA__@@",STACK:"@@__SLATE_STACK__@@",TEXT:"@@__SLATE_TEXT__@@",VALUE:"@@__SLATE_VALUE__@@"};function L(e,t){return!(!t||!t[z[e]])}var M=void 0,R=void 0;function D(){M=0,R=function(){return""+M++}}D();var I={create:function(e){if(null==e)return R();if("string"==typeof e)return e;throw new Error("Keys must be strings, but you passed: "+e)},setGenerator:function(e){R=e},resetGenerator:D},J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},U=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},H=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},q=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),$=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},X={data:new t.Map,isVoid:!1,key:void 0,nodes:new t.List,type:void 0},Y=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,type:this.type,isVoid:this.isVoid,data:this.data.toJSON(),nodes:this.nodes.toArray().map(function(t){return t.toJSON(e)})};return e.preserveKeys&&(t.key=this.key),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"block"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isEmpty",get:function(){return!this.isVoid&&!this.nodes.some(function(e){return!e.isEmpty})}},{key:"text",get:function(){return this.getText()}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isBlock(e))return e;if("string"==typeof e&&(e={type:e}),o(e))return r.fromJSON(e);throw new Error("`Block.create` only accepts objects, strings or blocks, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Block.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isBlock(e))return e;var n=e.data,o=void 0===n?{}:n,a=e.isVoid,i=void 0!==a&&a,s=e.key,u=void 0===s?I.create():s,c=e.nodes,l=void 0===c?[]:c,f=e.type;if("string"!=typeof f)throw new Error("`Block.fromJSON` requires a `type` string.");return new r({key:u,type:f,isVoid:!!i,data:t.Map(o),nodes:r.createChildren(l)})}},{key:"isBlockList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isBlock(e)})}}]),r}(t.Record(X));function Z(){throw new Error("setTimeout has not been defined")}function Q(){throw new Error("clearTimeout has not been defined")}Y.fromJS=Y.fromJSON,Y.isBlock=L.bind(null,"BLOCK"),Y.prototype[z.BLOCK]=!0;var ee=Z,te=Q;function re(e){if(ee===setTimeout)return setTimeout(e,0);if((ee===Z||!ee)&&setTimeout)return ee=setTimeout,setTimeout(e,0);try{return ee(e,0)}catch(t){try{return ee.call(null,e,0)}catch(t){return ee.call(this,e,0)}}}"function"==typeof a.setTimeout&&(ee=setTimeout),"function"==typeof a.clearTimeout&&(te=clearTimeout);var ne,oe=[],ae=!1,ie=-1;function se(){ae&&ne&&(ae=!1,ne.length?oe=ne.concat(oe):ie=-1,oe.length&&ue())}function ue(){if(!ae){var e=re(se);ae=!0;for(var t=oe.length;t;){for(ne=oe,oe=[];++ie<t;)ne&&ne[ie].run();ie=-1,t=oe.length}ne=null,ae=!1,function(e){if(te===clearTimeout)return clearTimeout(e);if((te===Q||!te)&&clearTimeout)return te=clearTimeout,clearTimeout(e);try{te(e)}catch(t){try{return te.call(null,e)}catch(t){return te.call(this,e)}}}(e)}}function ce(e,t){this.fun=e,this.array=t}ce.prototype.run=function(){this.fun.apply(null,this.array)};function le(){}var fe=le,he=le,de=le,ve=le,ye=le,pe=le,ge=le;var me=a.performance||{},ke=me.now||me.mozNow||me.msNow||me.oNow||me.webkitNow||function(){return(new Date).getTime()};var be=new Date;var Ae={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];oe.push(new ce(e,t)),1!==oe.length||ae||re(ue)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:fe,addListener:he,once:de,off:ve,removeListener:ye,removeAllListeners:pe,emit:ge,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*ke.call(me),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-be)/1e3}},Oe="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function we(e,t){return e(t={exports:{}},t.exports),t.exports}var xe=1e3,Te=60*xe,_e=60*Te,Be=24*_e,Ne=365.25*Be,Fe=function(e,t){t=t||{};var r,n=typeof e;if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*Ne;case"days":case"day":case"d":return r*Be;case"hours":case"hour":case"hrs":case"hr":case"h":return r*_e;case"minutes":case"minute":case"mins":case"min":case"m":return r*Te;case"seconds":case"second":case"secs":case"sec":case"s":return r*xe;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===n&&!1===isNaN(e))return t.long?je(r=e,Be,"day")||je(r,_e,"hour")||je(r,Te,"minute")||je(r,xe,"second")||r+" ms":function(e){if(e>=Be)return Math.round(e/Be)+"d";if(e>=_e)return Math.round(e/_e)+"h";if(e>=Te)return Math.round(e/Te)+"m";if(e>=xe)return Math.round(e/xe)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function je(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}var Se=we(function(e,t){function r(e){var r;function o(){if(o.enabled){var e=o,n=+new Date,a=n-(r||n);e.diff=a,e.prev=r,e.curr=n,r=n;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var u=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;u++;var o=t.formatters[n];if("function"==typeof o){var a=i[u];r=o.call(e,a),i.splice(u,1),u--}return r}),t.formatArgs.call(e,i),(o.log||t.log||console.log.bind(console)).apply(e,i)}}return o.namespace=e,o.enabled=t.enabled(e),o.useColors=t.useColors(),o.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),o.destroy=n,"function"==typeof t.init&&t.init(o),t.instances.push(o),o}function n(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(r=0;r<t.instances.length;r++){var a=t.instances[r];a.enabled=t.enabled(a.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=Fe,t.instances=[],t.names=[],t.skips=[],t.formatters={}}),Pe=(Se.coerce,Se.disable,Se.enable,Se.enabled,Se.humanize,Se.instances,Se.names,Se.skips,Se.formatters,we(function(e,t){function r(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==Ae&&"env"in Ae&&(e=Ae.env.DEBUG),e}(t=e.exports=Se).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(a=++o)}),e.splice(a,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=r,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(r())})),Ee=(Pe.log,Pe.formatArgs,Pe.save,Pe.load,Pe.useColors,Pe.storage,Pe.colors,Array.isArray),Ke="object"==typeof Oe&&Oe&&Oe.Object===Object&&Oe,Ce="object"==typeof self&&self&&self.Object===Object&&self,ze=Ke||Ce||Function("return this")(),Le=ze.Symbol,Me=Object.prototype,Re=Me.hasOwnProperty,De=Me.toString,Ie=Le?Le.toStringTag:void 0;var Je=function(e){var t=Re.call(e,Ie),r=e[Ie];try{e[Ie]=void 0;var n=!0}catch(e){}var o=De.call(e);return n&&(t?e[Ie]=r:delete e[Ie]),o},Ve=Object.prototype.toString;var Ue=function(e){return Ve.call(e)},Ge="[object Null]",We="[object Undefined]",He=Le?Le.toStringTag:void 0;var qe=function(e){return null==e?void 0===e?We:Ge:He&&He in Object(e)?Je(e):Ue(e)};var $e=function(e){return null!=e&&"object"==typeof e},Xe="[object Symbol]";var Ye=function(e){return"symbol"==typeof e||$e(e)&&qe(e)==Xe},Ze=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Qe=/^\w*$/;var et=function(e,t){if(Ee(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Ye(e))||Qe.test(e)||!Ze.test(e)||null!=t&&e in Object(t)};var tt=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},rt="[object AsyncFunction]",nt="[object Function]",ot="[object GeneratorFunction]",at="[object Proxy]";var it,st=function(e){if(!tt(e))return!1;var t=qe(e);return t==nt||t==ot||t==rt||t==at},ut=ze["__core-js_shared__"],ct=(it=/[^.]+$/.exec(ut&&ut.keys&&ut.keys.IE_PROTO||""))?"Symbol(src)_1."+it:"";var lt=function(e){return!!ct&&ct in e},ft=Function.prototype.toString;var ht=function(e){if(null!=e){try{return ft.call(e)}catch(e){}try{return e+""}catch(e){}}return""},dt=/^\[object .+?Constructor\]$/,vt=Function.prototype,yt=Object.prototype,pt=vt.toString,gt=yt.hasOwnProperty,mt=RegExp("^"+pt.call(gt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var kt=function(e){return!(!tt(e)||lt(e))&&(st(e)?mt:dt).test(ht(e))};var bt=function(e,t){return null==e?void 0:e[t]};var At=function(e,t){var r=bt(e,t);return kt(r)?r:void 0},Ot=At(Object,"create");var wt=function(){this.__data__=Ot?Ot(null):{},this.size=0};var xt=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Tt="__lodash_hash_undefined__",_t=Object.prototype.hasOwnProperty;var Bt=function(e){var t=this.__data__;if(Ot){var r=t[e];return r===Tt?void 0:r}return _t.call(t,e)?t[e]:void 0},Nt=Object.prototype.hasOwnProperty;var Ft=function(e){var t=this.__data__;return Ot?void 0!==t[e]:Nt.call(t,e)},jt="__lodash_hash_undefined__";var St=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ot&&void 0===t?jt:t,this};function Pt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Pt.prototype.clear=wt,Pt.prototype.delete=xt,Pt.prototype.get=Bt,Pt.prototype.has=Ft,Pt.prototype.set=St;var Et=Pt;var Kt=function(){this.__data__=[],this.size=0};var Ct=function(e,t){return e===t||e!=e&&t!=t};var zt=function(e,t){for(var r=e.length;r--;)if(Ct(e[r][0],t))return r;return-1},Lt=Array.prototype.splice;var Mt=function(e){var t=this.__data__,r=zt(t,e);return!(r<0||(r==t.length-1?t.pop():Lt.call(t,r,1),--this.size,0))};var Rt=function(e){var t=this.__data__,r=zt(t,e);return r<0?void 0:t[r][1]};var Dt=function(e){return zt(this.__data__,e)>-1};var It=function(e,t){var r=this.__data__,n=zt(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function Jt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Jt.prototype.clear=Kt,Jt.prototype.delete=Mt,Jt.prototype.get=Rt,Jt.prototype.has=Dt,Jt.prototype.set=It;var Vt=Jt,Ut=At(ze,"Map");var Gt=function(){this.size=0,this.__data__={hash:new Et,map:new(Ut||Vt),string:new Et}};var Wt=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Ht=function(e,t){var r=e.__data__;return Wt(t)?r["string"==typeof t?"string":"hash"]:r.map};var qt=function(e){var t=Ht(this,e).delete(e);return this.size-=t?1:0,t};var $t=function(e){return Ht(this,e).get(e)};var Xt=function(e){return Ht(this,e).has(e)};var Yt=function(e,t){var r=Ht(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Zt(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Zt.prototype.clear=Gt,Zt.prototype.delete=qt,Zt.prototype.get=$t,Zt.prototype.has=Xt,Zt.prototype.set=Yt;var Qt=Zt,er="Expected a function";function tr(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(er);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],a=r.cache;if(a.has(o))return a.get(o);var i=e.apply(this,n);return r.cache=a.set(o,i)||a,i};return r.cache=new(tr.Cache||Qt),r}tr.Cache=Qt;var rr=tr,nr=500;var or=/^\./,ar=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ir=/\\(\\)?/g,sr=function(e){var t=rr(e,function(e){return r.size===nr&&r.clear(),e}),r=t.cache;return t}(function(e){var t=[];return or.test(e)&&t.push(""),e.replace(ar,function(e,r,n,o){t.push(n?o.replace(ir,"$1"):r||e)}),t});var ur=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o},cr=1/0,lr=Le?Le.prototype:void 0,fr=lr?lr.toString:void 0;var hr=function e(t){if("string"==typeof t)return t;if(Ee(t))return ur(t,e)+"";if(Ye(t))return fr?fr.call(t):"";var r=t+"";return"0"==r&&1/t==-cr?"-0":r};var dr=function(e){return null==e?"":hr(e)};var vr=function(e,t){return Ee(e)?e:et(e,t)?[e]:sr(dr(e))},yr=1/0;var pr=function(e){if("string"==typeof e||Ye(e))return e;var t=e+"";return"0"==t&&1/e==-yr?"-0":t};var gr=function(e,t){for(var r=0,n=(t=vr(t,e)).length;null!=e&&r<n;)e=e[pr(t[r++])];return r&&r==n?e:void 0},mr=function(){try{var e=At(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var kr=function(e,t,r){"__proto__"==t&&mr?mr(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},br=Object.prototype.hasOwnProperty;var Ar=function(e,t,r){var n=e[t];br.call(e,t)&&Ct(n,r)&&(void 0!==r||t in e)||kr(e,t,r)},Or=9007199254740991,wr=/^(?:0|[1-9]\d*)$/;var xr=function(e,t){return!!(t=null==t?Or:t)&&("number"==typeof e||wr.test(e))&&e>-1&&e%1==0&&e<t};var Tr=function(e,t,r,n){if(!tt(e))return e;for(var o=-1,a=(t=vr(t,e)).length,i=a-1,s=e;null!=s&&++o<a;){var u=pr(t[o]),c=r;if(o!=i){var l=s[u];void 0===(c=n?n(l,u,s):void 0)&&(c=tt(l)?l:xr(t[o+1])?[]:{})}Ar(s,u,c),s=s[u]}return e};var _r=function(e,t,r){for(var n=-1,o=t.length,a={};++n<o;){var i=t[n],s=gr(e,i);r(s,i)&&Tr(a,vr(i,e),s)}return a};var Br=function(e,t){return null!=e&&t in Object(e)},Nr="[object Arguments]";var Fr=function(e){return $e(e)&&qe(e)==Nr},jr=Object.prototype,Sr=jr.hasOwnProperty,Pr=jr.propertyIsEnumerable,Er=Fr(function(){return arguments}())?Fr:function(e){return $e(e)&&Sr.call(e,"callee")&&!Pr.call(e,"callee")},Kr=9007199254740991;var Cr=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Kr};var zr=function(e,t,r){for(var n=-1,o=(t=vr(t,e)).length,a=!1;++n<o;){var i=pr(t[n]);if(!(a=null!=e&&r(e,i)))break;e=e[i]}return a||++n!=o?a:!!(o=null==e?0:e.length)&&Cr(o)&&xr(i,o)&&(Ee(e)||Er(e))};var Lr=function(e,t){return null!=e&&zr(e,t,Br)};var Mr=function(e,t){return _r(e,t,function(t,r){return Lr(e,r)})};var Rr=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},Dr=Le?Le.isConcatSpreadable:void 0;var Ir=function(e){return Ee(e)||Er(e)||!!(Dr&&e&&e[Dr])};var Jr=function e(t,r,n,o,a){var i=-1,s=t.length;for(n||(n=Ir),a||(a=[]);++i<s;){var u=t[i];r>0&&n(u)?r>1?e(u,r-1,n,o,a):Rr(a,u):o||(a[a.length]=u)}return a};var Vr=function(e){return null!=e&&e.length?Jr(e,1):[]};var Ur=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Gr=Math.max;var Wr=function(e,t,r){return t=Gr(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,a=Gr(n.length-t,0),i=Array(a);++o<a;)i[o]=n[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=n[o];return s[t]=r(i),Ur(e,this,s)}};var Hr=function(e){return function(){return e}};var qr=mr?function(e,t){return mr(e,"toString",{configurable:!0,enumerable:!1,value:Hr(t),writable:!0})}:function(e){return e},$r=800,Xr=16,Yr=Date.now;var Zr=function(e){var t=0,r=0;return function(){var n=Yr(),o=Xr-(n-r);if(r=n,o>0){if(++t>=$r)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(qr);var Qr=function(e){return Zr(Wr(e,void 0,Vr),e+"")},en=Qr(function(e,t){return null==e?{}:Mr(e,t)}),tn={data:new t.Map,isVoid:!1,key:void 0,nodes:new t.List,type:void 0},rn=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,type:this.type,isVoid:this.isVoid,data:this.data.toJSON(),nodes:this.nodes.toArray().map(function(t){return t.toJSON(e)})};return e.preserveKeys&&(t.key=this.key),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"inline"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isEmpty",get:function(){return!this.isVoid&&!this.nodes.some(function(e){return!e.isEmpty})}},{key:"text",get:function(){return this.getText()}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isInline(e))return e;if("string"==typeof e&&(e={type:e}),o(e))return r.fromJSON(e);throw new Error("`Inline.create` only accepts objects, strings or inlines, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Inline.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isInline(e))return e;var n=e.data,o=void 0===n?{}:n,a=e.isVoid,i=void 0!==a&&a,s=e.key,u=void 0===s?I.create():s,c=e.nodes,l=void 0===c?[]:c,f=e.type;if("string"!=typeof f)throw new Error("`Inline.fromJS` requires a `type` string.");return new r({key:u,type:f,isVoid:!!i,data:new t.Map(o),nodes:r.createChildren(l)})}},{key:"isInlineList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isInline(e)})}}]),r}(t.Record(tn));rn.fromJS=rn.fromJSON,rn.isInline=L.bind(null,"INLINE"),rn.prototype[z.INLINE]=!0;var nn=function(){function e(){V(this,e)}return U(e,null,[{key:"create",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.Map.isMap(r))return r;if(o(r))return e.fromJSON(r);throw new Error("`Data.create` only accepts objects or maps, but you passed it: "+r)}},{key:"fromJSON",value:function(e){return new t.Map(e)}}]),e}();nn.fromJS=nn.fromJSON;var on=!0,an=0,sn={},un={},cn=void 0;function ln(e,t){var r=function(t){var r=e[t];if(!r)throw new Error('Object does not have a property named "'+t+'".');e[t]=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];if(!on)return r.apply(this,n);an!==this.__cache_key&&(this.__cache_key=an,this.__cache=new Map,this.__cache_no_args={}),this.__cache||(this.__cache=new Map),this.__cache_no_args||(this.__cache_no_args={});var a=0!==n.length,i=void 0,s=void 0;if(a?(s=[t].concat(n),i=function(e,t){var r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;if((e=e.get(s))===cn)return cn}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return e.get(sn)}(this.__cache,s)):i=this.__cache_no_args[t],i!==cn)return i===un?void 0:i;var u=r.apply(this,n),c=void 0===u?un:u;return a?this.__cache=function(e,t,r){var n=e,o=void 0,a=!0,i=!1,s=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;(o=n.get(l))===cn&&(o=new Map,n.set(l,o)),n=o}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}return o.set(sn,r),e}(this.__cache,s,c):this.__cache_no_args[t]=c,u}},n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){r(i.value)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}function fn(){++an>=Number.MAX_SAFE_INTEGER&&(an=0)}function hn(e){on=e}var dn={data:new t.Map,type:void 0},vn=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"getComponent",value:function(e){return e.__getComponent(this)}},{key:"toJSON",value:function(){return{object:this.object,type:this.type,data:this.data.toJSON()}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"mark"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isMark(e))return e;if("string"==typeof e&&(e={type:e}),o(e))return r.fromJSON(e);throw new Error("`Mark.create` only accepts objects, strings or marks, but you passed it: "+e)}},{key:"createSet",value:function(e){if(t.Set.isSet(e)||Array.isArray(e))return new t.Set(e.map(r.create));if(null==e)return t.Set();throw new Error("`Mark.createSet` only accepts sets, arrays or null, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isMark(e))return{data:e.data,type:e.type};if("string"==typeof e)return{type:e};if(o(e)){var t={};return"type"in e&&(t.type=e.type),"data"in e&&(t.data=nn.create(e.data)),t}throw new Error("`Mark.createProperties` only accepts objects, strings or marks, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=e.data,o=void 0===n?{}:n,a=e.type;if("string"!=typeof a)throw new Error("`Mark.fromJS` requires a `type` string.");return new r({type:a,data:new t.Map(o)})}},{key:"isMarkSet",value:function(e){return t.Set.isSet(e)&&e.every(function(e){return r.isMark(e)})}}]),r}(t.Record(dn));vn.fromJS=vn.fromJSON,vn.isMark=L.bind(null,"MARK"),vn.prototype[z.MARK]=!0,ln(vn.prototype,["getComponent"]);var yn,pn,gn={};["deleteBackward","deleteCharBackward","deleteLineBackward","deleteWordBackward","deleteForward","deleteCharForward","deleteWordForward","deleteLineForward","setBlocks","setInlines","splitInline","unwrapBlock","unwrapInline","wrapBlock","wrapInline"].forEach(function(e){gn[e]=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=t.value.selection;t[e+"AtRange"].apply(t,[a].concat(n)),e.match(/Backward$/)?t.collapseToStart():e.match(/Forward$/)&&t.collapseToEnd()}}),gn.setBlock=function(){C.deprecate("slate@0.33.0","The `setBlock` method of Slate changes has been renamed to `setBlocks`."),gn.setBlocks.apply(gn,arguments)},gn.setInline=function(){C.deprecate("slate@0.33.0","The `setInline` method of Slate changes has been renamed to `setInlines`."),gn.setInlines.apply(gn,arguments)},gn.addMark=function(e,t){t=vn.create(t);var r=e.value,n=r.document,o=r.selection;if(o.isExpanded)e.addMarkAtRange(o,t);else if(o.marks){var a=o.marks.add(t),i=o.set("marks",a);e.select(i)}else{var s=n.getActiveMarksAtRange(o).add(t),u=o.set("marks",s);e.select(u)}},gn.addMarks=function(e,t){t.forEach(function(t){return e.addMark(t)})},gn.delete=function(e){var t=e.value.selection;e.deleteAtRange(t),e.collapseToStart()},gn.insertBlock=function(e,t){t=Y.create(t);var r=e.value.selection;e.insertBlockAtRange(r,t);var n=e.value.document.getNode(t.key);n&&e.collapseToEndOf(n)},gn.insertFragment=function(e,t){if(t.nodes.size){var r=e.value,n=r,o=n.document,a=n.selection,i=r,s=i.startText,u=i.endText,c=i.startInline,l=t.getLastText(),f=t.getClosestInline(l.key),h=t.nodes.first(),d=t.nodes.last(),v=o.getTexts().map(function(e){return e.key}),y=!c||a.hasEdgeAtStartOf(s)||a.hasEdgeAtEndOf(u),p=h.hasBlockChildren()||d.hasBlockChildren();e.insertFragmentAtRange(a,t);var g=(o=(r=e.value).document).getTexts().filter(function(e){return!v.includes(e.key)}),m=y?g.last():g.takeLast(2).first();m&&(f||p)?e.select(a.collapseToEndOf(m)):m?e.select(a.collapseToStartOf(m).move(l.text.length)):e.select(a.collapseToStart().move(l.text.length))}},gn.insertInline=function(e,t){t=rn.create(t);var r=e.value.selection;e.insertInlineAtRange(r,t);var n=e.value.document.getNode(t.key);n&&e.collapseToEndOf(n)},gn.insertText=function(e,t,r){var n=e.value,o=n.document,a=n.selection;r=r||a.marks||o.getInsertMarksAtRange(a),e.insertTextAtRange(a,t,r),a.marks&&o!=e.value.document&&e.select({marks:null})},gn.splitBlock=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.value,n=r.selection,o=r.document,a=n.marks||o.getInsertMarksAtRange(n);e.splitBlockAtRange(n,t).collapseToEnd(),a&&0!==a.size&&e.select({marks:a})},gn.removeMark=function(e,t){t=vn.create(t);var r=e.value,n=r.document,o=r.selection;if(o.isExpanded)e.removeMarkAtRange(o,t);else if(o.marks){var a=o.marks.remove(t),i=o.set("marks",a);e.select(i)}else{var s=n.getActiveMarksAtRange(o).remove(t),u=o.set("marks",s);e.select(u)}},gn.replaceMark=function(e,t,r){e.removeMark(t),e.addMark(r)},gn.toggleMark=function(e,t){t=vn.create(t),e.value.activeMarks.has(t)?e.removeMark(t):e.addMark(t)},gn.wrapText=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,n=e.value.selection;e.wrapTextAtRange(n,t,r),n.isCollapsed&&e.moveStart(0-t.length),e.moveEnd(0-r.length),n.isForward!=e.value.selection.isForward&&e.flip()},yn=new RegExp("^[^֑-߿יִ-﷽ﹰ-ﻼ]*[A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿]"),pn=new RegExp("^[^A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿]*[֑-߿יִ-﷽ﹰ-ﻼ]");var mn=function(e){return e=e.toString(),pn.test(e)?"rtl":yn.test(e)?"ltr":"neutral"},kn={data:new t.Map,key:void 0,nodes:new t.List},bn=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,data:this.data.toJSON(),nodes:this.nodes.toArray().map(function(t){return t.toJSON(e)})};return e.preserveKeys&&(t.key=this.key),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"document"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isEmpty",get:function(){return!this.nodes.some(function(e){return!e.isEmpty})}},{key:"text",get:function(){return this.getText()}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isDocument(e))return e;if((t.List.isList(e)||Array.isArray(e))&&(e={nodes:e}),o(e))return r.fromJSON(e);throw new Error("`Document.create` only accepts objects, arrays, lists or documents, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isDocument(e))return e;var n=e.data,o=void 0===n?{}:n,a=e.key,i=void 0===a?I.create():a,s=e.nodes,u=void 0===s?[]:s;return new r({key:i,data:new t.Map(o),nodes:r.createChildren(u)})}}]),r}(t.Record(kn));function An(e,t){if(e.size!==t.size)return null;for(var r=0;r<e.size;r++){var n=e.get(r),o=t.get(r);if(n<o)return-1;if(n>o)return 1}return 0}function On(e){if(null==e)return null;if(t.List.isList(e))return e;if(Array.isArray(e))return t.List(e);throw new Error("Paths can only be created from arrays or lists, but you passed: "+e)}function wn(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tn(e,t);return[e.slice(0,r),t.slice(0,r)]}function xn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size-1,n=e.get(r)+t;return e.set(r,n)}function Tn(e,t){return Math.min(e.size,t.size)}bn.fromJS=bn.fromJSON,bn.isDocument=L.bind(null,"DOCUMENT"),bn.prototype[z.DOCUMENT]=!0;var _n={compare:An,create:On,crop:wn,decrement:function(e){return xn(e,0-(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size-1)},increment:xn,isAbove:function(e,t){var r=wn(e,t),n=q(r,2),o=n[0],a=n[1];return e.size<t.size&&0===An(o,a)},isAfter:function(e,t){var r=wn(e,t),n=q(r,2);return 1===An(n[0],n[1])},isBefore:function(e,t){var r=wn(e,t),n=q(r,2);return-1===An(n[0],n[1])},lift:function(e){return e.slice(0,-1)},max:function(e,t){return Math.max(e.size,t.size)},min:Tn,relate:function(e,t){for(var r=[],n=0;n<e.size&&n<t.size;n++){var o=e.get(n);if(o!==t.get(n))break;r.push(o)}return On(r)}},Bn=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"hasAnchorAtStartOf",value:function(e){if(0!=this.anchorOffset)return!1;var t=Nn(e);return this.anchorKey==t.key}},{key:"hasAnchorAtEndOf",value:function(e){var t=Fn(e);return this.anchorKey==t.key&&this.anchorOffset==t.text.length}},{key:"hasAnchorBetween",value:function(e,t,r){return this.anchorOffset<=r&&t<=this.anchorOffset&&this.hasAnchorIn(e)}},{key:"hasAnchorIn",value:function(e){return"text"==e.object?e.key==this.anchorKey:null!=this.anchorKey&&e.hasDescendant(this.anchorKey)}},{key:"hasFocusAtEndOf",value:function(e){var t=Fn(e);return this.focusKey==t.key&&this.focusOffset==t.text.length}},{key:"hasFocusAtStartOf",value:function(e){if(0!=this.focusOffset)return!1;var t=Nn(e);return this.focusKey==t.key}},{key:"hasFocusBetween",value:function(e,t,r){return t<=this.focusOffset&&this.focusOffset<=r&&this.hasFocusIn(e)}},{key:"hasFocusIn",value:function(e){return"text"==e.object?e.key==this.focusKey:null!=this.focusKey&&e.hasDescendant(this.focusKey)}},{key:"isAtStartOf",value:function(e){return this.isCollapsed&&this.hasAnchorAtStartOf(e)}},{key:"isAtEndOf",value:function(e){return this.isCollapsed&&this.hasAnchorAtEndOf(e)}},{key:"focus",value:function(){return this.merge({isFocused:!0})}},{key:"blur",value:function(){return this.merge({isFocused:!1})}},{key:"deselect",value:function(){return this.merge({anchorKey:null,anchorOffset:0,anchorPath:null,focusKey:null,focusOffset:0,focusPath:null,isFocused:!1,isBackward:!1})}},{key:"flip",value:function(){return this.merge({anchorKey:this.focusKey,anchorOffset:this.focusOffset,anchorPath:this.focusPath,focusKey:this.anchorKey,focusOffset:this.anchorOffset,focusPath:this.anchorPath,isBackward:null==this.isBackward?null:!this.isBackward})}},{key:"moveAnchor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.anchorKey,r=this.focusKey,n=this.focusOffset,o=this.isBackward,a=this.anchorOffset+e;return this.merge({anchorOffset:a,isBackward:t==r?a>n:o})}},{key:"moveFocus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.anchorKey,r=this.anchorOffset,n=this.focusKey,o=this.isBackward,a=this.focusOffset+e;return this.merge({focusOffset:a,isBackward:n==t?r>a:o})}},{key:"moveAnchorTo",value:function(e,t){var r=this.anchorKey,n=this.focusKey,o=this.focusOffset,a=this.anchorPath,i=this.focusPath,s=this.isBackward;if("string"==typeof e){var u=e===r,c=e===n;return this.merge({anchorKey:e,anchorPath:c?i:u?a:null,anchorOffset:t,isBackward:c?t>o:u?s:null})}var l=e,f=l&&l.equals(a),h=l&&l.equals(i);return this.merge({anchorPath:l,anchorKey:f?r:h?n:null,anchorOffset:t,isBackward:h?t>o:f?s:null})}},{key:"moveFocusTo",value:function(e,t){var r=this.focusKey,n=this.anchorKey,o=this.anchorOffset,a=this.anchorPath,i=this.focusPath,s=this.isBackward;if("string"==typeof e){var u=e===n,c=e===r;return this.merge({focusKey:e,focusPath:u?a:c?i:null,focusOffset:t,isBackward:u?t<o:c?s:null})}var l=e,f=l&&l.equals(a),h=l&&l.equals(i);return this.merge({focusPath:l,focusKey:h?r:f?n:null,focusOffset:t,isBackward:f?t<o:h?s:null})}},{key:"moveAnchorOffsetTo",value:function(e){return this.merge({anchorOffset:e,isBackward:this.anchorKey==this.focusKey?e>this.focusOffset:this.isBackward})}},{key:"moveFocusOffsetTo",value:function(e){return this.merge({focusOffset:e,isBackward:this.anchorKey==this.focusKey?this.anchorOffset>e:this.isBackward})}},{key:"moveOffsetsTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.moveAnchorOffsetTo(e).moveFocusOffsetTo(t)}},{key:"moveToAnchor",value:function(){return this.moveFocusTo(this.anchorKey,this.anchorOffset)}},{key:"moveToFocus",value:function(){return this.moveAnchorTo(this.focusKey,this.focusOffset)}},{key:"moveAnchorToStartOf",value:function(e){return e=Nn(e),this.moveAnchorTo(e.key,0)}},{key:"moveAnchorToEndOf",value:function(e){return e=Fn(e),this.moveAnchorTo(e.key,e.text.length)}},{key:"moveFocusToStartOf",value:function(e){return e=Nn(e),this.moveFocusTo(e.key,0)}},{key:"moveFocusToEndOf",value:function(e){return e=Fn(e),this.moveFocusTo(e.key,e.text.length)}},{key:"moveToRangeOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return(this.isBackward?this.flip():this).moveAnchorToStartOf(e).moveFocusToEndOf(t)}},{key:"normalize",value:function(e){var t=this.anchorKey,r=this.anchorOffset,n=this.anchorPath,o=this.focusKey,a=this.focusOffset,i=this.focusPath,s=this.isBackward,u=void 0===r?"undefined":J(r),c=void 0===a?"undefined":J(a);if("number"==u&&"number"==c||C.warn('The range offsets should be numbers, but they were of type "'+u+'" and "'+c+'".'),null==t&&null==n||null==o&&null==i)return this.merge({anchorKey:null,anchorOffset:0,anchorPath:null,focusKey:null,focusOffset:0,focusPath:null,isBackward:!1});var l=e.getNode(t||n),f=e.getNode(o||i);if(!l||!f){C.warn("The range was invalid and was reset. The range in question was:",this);var h=e.getFirstText(),d=h&&e.getPath(h.key);return this.merge({anchorKey:h?h.key:null,anchorOffset:0,anchorPath:h?d:null,focusKey:h?h.key:null,focusOffset:0,focusPath:h?d:null,isBackward:!1})}if("text"!=l.object){C.warn("The range anchor was set to a Node that is not a Text node. This should not happen and can degrade performance. The node in question was:",l);var v=l.getTextAtOffset(r);r-=l.getOffset(v.key),l=v}if("text"!=f.object){C.warn("The range focus was set to a Node that is not a Text node. This should not happen and can degrade performance. The node in question was:",f);var y=f.getTextAtOffset(a);a-=f.getOffset(y.key),f=y}if(t=l.key,o=f.key,n=e.getPath(t),i=e.getPath(o),null==s){var p=_n.compare(n,i);s=0===p?r>a:1===p}return this.merge({anchorKey:t,anchorOffset:r,anchorPath:n,focusKey:o,focusOffset:a,focusPath:i,isBackward:s})}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,anchorKey:this.anchorKey,anchorOffset:this.anchorOffset,anchorPath:this.anchorPath&&this.anchorPath.toArray(),focusKey:this.focusKey,focusOffset:this.focusOffset,focusPath:this.focusPath&&this.focusPath.toArray(),isAtomic:this.isAtomic,isBackward:this.isBackward,isFocused:this.isFocused,marks:null==this.marks?null:this.marks.toArray().map(function(e){return e.toJSON()})};return e.preserveKeys||(delete t.anchorKey,delete t.focusKey),t}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"range"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isBlurred",get:function(){return!this.isFocused}},{key:"isCollapsed",get:function(){return this.anchorKey==this.focusKey&&this.anchorOffset==this.focusOffset}},{key:"isExpanded",get:function(){return!this.isCollapsed}},{key:"isForward",get:function(){return null==this.isBackward?null:!this.isBackward}},{key:"isSet",get:function(){return null!=this.anchorKey&&null!=this.focusKey||null!=this.anchorPath&&null!=this.focusPath}},{key:"isUnset",get:function(){return!this.isSet}},{key:"startKey",get:function(){return this.isBackward?this.focusKey:this.anchorKey}},{key:"startOffset",get:function(){return this.isBackward?this.focusOffset:this.anchorOffset}},{key:"startPath",get:function(){return this.isBackward?this.focusPath:this.anchorPath}},{key:"endKey",get:function(){return this.isBackward?this.anchorKey:this.focusKey}},{key:"endOffset",get:function(){return this.isBackward?this.anchorOffset:this.focusOffset}},{key:"endPath",get:function(){return this.isBackward?this.anchorPath:this.focusPath}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isRange(e))return e;if(o(e))return r.fromJSON(e);throw new Error("`Range.create` only accepts objects or ranges, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Range.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isRange(e))return{anchorKey:e.anchorKey,anchorOffset:e.anchorOffset,anchorPath:e.anchorPath,focusKey:e.focusKey,focusOffset:e.focusOffset,focusPath:e.focusPath,isAtomic:e.isAtomic,isBackward:e.isBackward,isFocused:e.isFocused,marks:e.marks};if(o(e)){var t={};return"anchorKey"in e&&(t.anchorKey=e.anchorKey),"anchorOffset"in e&&(t.anchorOffset=e.anchorOffset),"anchorPath"in e&&(t.anchorPath=_n.create(e.anchorPath)),"focusKey"in e&&(t.focusKey=e.focusKey),"focusOffset"in e&&(t.focusOffset=e.focusOffset),"focusPath"in e&&(t.focusPath=_n.create(e.focusPath)),"isAtomic"in e&&(t.isAtomic=e.isAtomic),"isBackward"in e&&(t.isBackward=e.isBackward),"isFocused"in e&&(t.isFocused=e.isFocused),"marks"in e&&(t.marks=null==e.marks?null:vn.createSet(e.marks)),"anchorPath"in e&&!("anchorKey"in e)&&(t.anchorKey=null),"anchorKey"in e&&!("anchorPath"in e)&&(t.anchorPath=null),"focusPath"in e&&!("focusKey"in e)&&(t.focusKey=null),"focusKey"in e&&!("focusPath"in e)&&(t.focusPath=null),t}throw new Error("`Range.createProperties` only accepts objects or ranges, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=e.anchorKey,o=void 0===n?null:n,a=e.anchorOffset,i=void 0===a?0:a,s=e.anchorPath,u=void 0===s?null:s,c=e.focusKey,l=void 0===c?null:c,f=e.focusOffset,h=void 0===f?0:f,d=e.focusPath,v=void 0===d?null:d,y=e.isAtomic,p=void 0!==y&&y,g=e.isBackward,m=void 0===g?null:g,k=e.isFocused,b=void 0!==k&&k,A=e.marks,O=void 0===A?null:A;return new r({anchorKey:o,anchorOffset:i,anchorPath:_n.create(u),focusKey:l,focusOffset:h,focusPath:_n.create(v),isAtomic:p,isBackward:m,isFocused:b,marks:null==O?null:new t.Set(O.map(vn.fromJSON))})}},{key:"isRange",value:function(e){return!(!e||!e[z.RANGE])}}]),r}(t.Record({anchorKey:null,anchorOffset:0,anchorPath:null,focusKey:null,focusOffset:0,focusPath:null,isAtomic:!1,isBackward:null,isFocused:!1,marks:null}));Bn.fromJS=Bn.fromJSON,Bn.prototype[z.RANGE]=!0;[["move",""],["move","To"],["move","ToStartOf"],["move","ToEndOf"]].forEach(function(e){var t=q(e,2),r=t[0],n=t[1];Bn.prototype[""+r+n]=function(){var e;return(e=this[r+"Anchor"+n].apply(this,arguments))[r+"Focus"+n].apply(e,arguments)}});[["has","AtStartOf",!0],["has","AtEndOf",!0],["has","Between",!0],["has","In",!0],["collapseTo",""],["move",""],["moveTo",""],["move","To"],["move","OffsetTo"]].forEach(function(e){var t=q(e,3),r=t[0],n=t[1],o=t[2],a=r+"Anchor"+n,i=r+"Focus"+n;Bn.prototype[r+"Start"+n]=function(){return this.isBackward?this[i].apply(this,arguments):this[a].apply(this,arguments)},Bn.prototype[r+"End"+n]=function(){return this.isBackward?this[a].apply(this,arguments):this[i].apply(this,arguments)},o&&(Bn.prototype[r+"Edge"+n]=function(){return this[a].apply(this,arguments)||this[i].apply(this,arguments)})});function Nn(e){return"text"==e.object?e:e.getFirstText()}function Fn(e){return"text"==e.object?e:e.getLastText()}[["collapseTo","moveTo"],["collapseToAnchor","moveToAnchor"],["collapseToFocus","moveToFocus"],["collapseToStart","moveToStart"],["collapseToEnd","moveToEnd"],["collapseToStartOf","moveToStartOf"],["collapseToEndOf","moveToEndOf"],["extend","moveFocus"],["extendTo","moveFocusTo"],["extendToStartOf","moveFocusToStartOf"],["extendToEndOf","moveFocusToEndOf"]].forEach(function(e){var t=q(e,2),r=t[0],n=t[1];Bn.prototype[r]=function(){return this[n].apply(this,arguments)}});var jn={marks:new t.Set,text:""},Sn=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"toJSON",value:function(){return{object:this.object,text:this.text,marks:this.marks.toArray().map(function(e){return e.toJSON()})}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"character"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isCharacter(e))return e;if("string"==typeof e&&(e={text:e}),o(e))return r.fromJSON(e);throw new Error("`Character.create` only accepts objects, strings or characters, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if("string"==typeof e&&(e=e.split("")),t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Block.createList` only accepts strings, arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=e.text,o=e.marks,a=void 0===o?[]:o;if("string"!=typeof n)throw new Error("`Character.fromJSON` requires a block `text` string.");return new r({text:n,marks:new t.Set(a)})}},{key:"isCharacterList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isCharacter(e)})}}]),r}(t.Record(jn));Sn.fromJS=Sn.fromJSON,Sn.isCharacter=L.bind(null,"CHARACTER"),Sn.prototype[z.CHARACTER]=!0;var Pn={marks:t.Set(),text:""},En=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"getCharacters",value:function(){C.deprecate("slate@0.34.0","The `characters` property of Slate objects is deprecated");var e=this.marks;return Sn.createList(this.text.split("").map(function(t){return Sn.create({text:t,marks:e})}))}},{key:"updateMark",value:function(e,t){var r=this.marks;if(t.equals(e))return this;if(!r.has(e))return this;var n=r.withMutations(function(r){r.remove(e).add(t)});return this.set("marks",n)}},{key:"addMarks",value:function(e){var t=this.marks;return this.set("marks",t.union(e))}},{key:"removeMark",value:function(e){var t=this.marks;return this.set("marks",t.remove(e))}},{key:"toJSON",value:function(){return{object:this.object,text:this.text,marks:this.marks.toArray().map(function(e){return e.toJSON()})}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"leaf"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isLeaf(e))return e;if("string"==typeof e&&(e={text:e}),o(e))return r.fromJSON(e);throw new Error("`Leaf.create` only accepts objects, strings or leaves, but you passed it: "+e)}},{key:"createLeaves",value:function(e){if(e.size<=1)return e;var r=!1,n=t.List().withMutations(function(t){e.findLast(function(e,n){var o=t.first();if(o){if(o.marks.equals(e.marks))return r=!0,void t.set(0,o.set("text",""+e.text+o.text));if(""===o.text)return r=!0,void t.set(0,e);if(""===e.text)return void(r=!0)}t.unshift(e)})});return r?n:e}},{key:"splitLeaves",value:function(e,r){if(r<0)return[t.List(),e];if(0===e.size)return[t.List(),t.List()];var n=0,o=-1,a=void 0,i=void 0;return e.find(function(e){o++;var t=n,s=e.text;if((n+=s.length)<r)return!1;if(t>r)return!1;var u=r-t;return a=e.set("text",s.slice(0,u)),i=e.set("text",s.slice(u)),!0}),a?""===a.text?0===o?[t.List.of(a),e]:[e.take(o),e.skip(o)]:""===i.text?o===e.size-1?[e,t.List.of(i)]:[e.take(o+1),e.skip(o+1)]:[e.take(o).push(a),e.skip(o+1).unshift(i)]:[e,t.List()]}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Leaf.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=e.text,o=void 0===n?"":n,a=e.marks,i=void 0===a?[]:a;return new r({text:o,marks:t.Set(i.map(vn.fromJSON))})}},{key:"isLeafList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isLeaf(e)})}}]),r}(t.Record(Pn));En.fromJS=En.fromJSON,En.isLeaf=L.bind(null,"LEAF"),En.prototype[z.LEAF]=!0;var Kn={leaves:t.List(),key:void 0},Cn=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"getString",value:function(){return this.leaves.reduce(function(e,t){return e+t.text},"")}},{key:"searchLeafAtOffset",value:function(e){var t=0,r=0,n=-1;return{leaf:this.leaves.find(function(o){return n++,(t=(r=t)+o.text.length)>=e}),endOffset:t,index:n,startOffset:r}}},{key:"addMark",value:function(e,r,n){var o=t.Set.of(n);return this.addMarks(e,r,o)}},{key:"addMarks",value:function(e,r,n){if(""===this.text&&0===r&&0===e){var o=this.leaves.first();if(!o)return this.set("leaves",t.List.of(En.fromJSON({text:"",marks:n})));var a=o.addMarks(n);return a===o?this:this.set("leaves",t.List.of(a))}if(""===this.text)return this;if(0===r)return this;if(e>=this.text.length)return this;var i=En.splitLeaves(this.leaves,e),s=q(i,2),u=s[0],c=s[1],l=En.splitLeaves(c,r),f=q(l,2),h=f[0],d=f[1],v=u.concat(h.map(function(e){return e.addMarks(n)}),d);return this.setLeaves(v)}},{key:"getDecorations",value:function(e){return e.__getDecorations(this)}},{key:"getLeaves",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.leaves;if(0===n.size)return t.List.of(En.create({}));if(!r||0===r.length)return n;if(0===this.text.length)return n;var o=this.key;return r.forEach(function(t){var r=t.startKey,a=t.endKey,i=t.startOffset,s=t.endOffset,u=t.marks,c=r==o,l=a==o;if(c&&l){var f=c?i:0,h=l?s-f:e.text.length-f;if(h<1)return;if(f>=e.text.length)return;if(0!==f||h<e.text.length){var d=En.splitLeaves(n,f),v=q(d,2),y=v[0],p=v[1],g=En.splitLeaves(p,h),m=q(g,2),k=m[0],b=m[1];return void(n=y.concat(k.map(function(e){return e.addMarks(u)}),b))}}n=n.map(function(e){return e.addMarks(u)})}),n===this.leaves?n:En.createLeaves(n)}},{key:"getActiveMarksBetweenOffsets",value:function(e,r){if(e<=0&&r>=this.text.length)return this.getActiveMarks();if(e>=r)return t.Set();if(""===this.text)return this.getActiveMarks();var n=null,o=0;return this.leaves.forEach(function(t){var a=o;if(!((o=a+t.text.length)<=e)){if(a>=r)return!1;if(n)return(n=n.intersect(t.marks))&&n.size,!1;n=t.marks}}),n||t.Set()}},{key:"getActiveMarks",value:function(){var e=this;if(0===this.leaves.size)return t.Set();var r=this.leaves.first().marks;return 0===r.size?r:r.withMutations(function(t){e.leaves.forEach(function(e){if(t.intersect(e.marks),0===t.size)return!1})})}},{key:"getFirstText",value:function(){return this}},{key:"getLastText",value:function(){return this}},{key:"getMarksBetweenOffsets",value:function(e,r){if(e<=0&&r>=this.text.length)return this.getMarks();if(e>=r)return t.Set();if(""===this.text)return this.getActiveMarks();var n=null,o=0;return this.leaves.forEach(function(t){var a=o;if(!((o=a+t.text.length)<=e))return!(a>=r)&&void(n=n?n.union(t.marks):t.marks)}),n||t.Set()}},{key:"getMarks",value:function(){var e=this.getMarksAsArray();return new t.OrderedSet(e)}},{key:"getMarksAsArray",value:function(){if(0===this.leaves.size)return[];var e=this.leaves.first().marks;if(1===this.leaves.size)return e.toArray();var t=[];return this.leaves.forEach(function(e){t.push(e.marks.toArray())}),Array.prototype.concat.apply(e.toArray(),t)}},{key:"getMarksAtIndex",value:function(e){var r=this.searchLeafAtOffset(e).leaf;return r?r.marks:t.Set()}},{key:"getNode",value:function(e){return this.key==e?this:null}},{key:"hasNode",value:function(e){return!!this.getNode(e)}},{key:"insertText",value:function(e,r,n){if(""===this.text)return this.set("leaves",t.List.of(En.create({text:r,marks:n})));if(0===r.length)return this;n||(n=t.Set());var o=this.searchLeafAtOffset(e),a=o.startOffset,i=o.leaf,s=o.index,u=e-a,c=i.text.slice(0,u),l=i.text.slice(u),f=this.leaves;if(i.marks.equals(n))return this.set("leaves",f.set(s,i.set("text",c+r+l)));var h=f.splice(s,1,i.set("text",c),En.create({text:r,marks:n}),i.set("text",l));return this.setLeaves(h)}},{key:"regenerateKey",value:function(){var e=I.create();return this.set("key",e)}},{key:"removeMark",value:function(e,r,n){if(""===this.text&&0===e&&0===r){var o=this.leaves.first();if(!o)return this;var a=o.removeMark(n);return a===o?this:this.set("leaves",t.List.of(a))}if(r<=0)return this;if(e>=this.text.length)return this;var i=En.splitLeaves(this.leaves,e),s=q(i,2),u=s[0],c=s[1],l=En.splitLeaves(c,r),f=q(l,2),h=f[0],d=f[1],v=u.concat(h.map(function(e){return e.removeMark(n)}),d);return this.setLeaves(v)}},{key:"removeText",value:function(e,r){if(r<=0)return this;if(e>=this.text.length)return this;if(1===r){var n=this.searchLeafAtOffset(e+1),o=n.leaf,a=n.index,i=e-n.startOffset;if(o){if(1===o.text.length){var s=this.leaves.remove(a);return this.setLeaves(s)}var u=o.text.slice(0,i)+o.text.slice(i+r);if(u.length>0)return this.set("leaves",this.leaves.set(a,o.set("text",u)))}}var c=En.splitLeaves(this.leaves,e),l=q(c,2),f=l[0],h=l[1],d=En.splitLeaves(h,r)[1],v=En.createLeaves(f.concat(d));if(1===v.size){var y=v.first();if(""===y.text)return this.set("leaves",t.List.of(y.set("marks",this.getActiveMarks())))}return this.set("leaves",v)}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,leaves:this.getLeaves().toArray().map(function(e){return e.toJSON()})};return e.preserveKeys&&(t.key=this.key),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"updateMark",value:function(e,r,n,o){var a=n.merge(o);if(""===this.text&&0===r&&0===e){var i=this.leaves.first();if(!i)return this;var s=i.updateMark(n,a);return s===i?this:this.set("leaves",t.List.of(s))}if(r<=0)return this;if(e>=this.text.length)return this;var u=En.splitLeaves(this.leaves,e),c=q(u,2),l=c[0],f=c[1],h=En.splitLeaves(f,r),d=q(h,2),v=d[0],y=d[1],p=l.concat(v.map(function(e){return e.updateMark(n,a)}),y);return this.setLeaves(p)}},{key:"splitText",value:function(e){var t=En.splitLeaves(this.leaves,e);return[this.set("leaves",t[0]),this.set("leaves",t[1]).regenerateKey()]}},{key:"mergeText",value:function(e){var t=this.leaves.concat(e.leaves);return this.setLeaves(t)}},{key:"normalize",value:function(e){return e.normalizeNode(this)}},{key:"validate",value:function(e){return e.validateNode(this)}},{key:"getFirstInvalidDescendant",value:function(e){return this.validate(e)?this:null}},{key:"setLeaves",value:function(e){var r=En.createLeaves(e);if(1===r.size){var n=r.first();if((!n.marks||0===n.marks.size)&&""===n.text)return this.set("leaves",t.List())}return this.set("leaves",En.createLeaves(e))}},{key:"object",get:function(){return"text"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"isEmpty",get:function(){return""==this.text}},{key:"text",get:function(){return this.getString()}},{key:"characters",get:function(){return this.leaves.flatMap(function(e){return e.getCharacters()})}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(r.isText(e))return e;if("string"==typeof e&&(e={leaves:[{text:e}]}),o(e)){if(e.text){var t=e,n=t.text,a=t.marks;e={key:t.key,leaves:[{text:n,marks:a}]}}return r.fromJSON(e)}throw new Error("`Text.create` only accepts objects, arrays, strings or texts, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Text.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isText(e))return e;var n=e.key,o=void 0===n?I.create():n,a=e.leaves;if(a||(e.ranges?(C.deprecate("slate@0.27.0","The `ranges` property of Slate objects has been renamed to `leaves`."),a=e.ranges):a=t.List()),Array.isArray(a))a=t.List(a.map(function(e){return En.create(e)}));else{if(!t.List.isList(a))throw new Error("leaves must be either Array or Immutable.List");a=a.map(function(e){return En.create(e)})}return new r({leaves:En.createLeaves(a),key:o})}},{key:"isTextList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isText(e)})}}]),r}(t.Record(Kn));Cn.fromJS=Cn.fromJSON,Cn.isText=L.bind(null,"TEXT"),Cn.prototype[z.TEXT]=!0,ln(Cn.prototype,["getDecorations","getActiveMarks","getMarks","getMarksAsArray","normalize","validate","getString"]);var zn=function(){function e(){V(this,e)}return U(e,[{key:"addMark",value:function(e,t,r,n){var o=this.assertDescendant(e);return e=this.resolvePath(e),o=o.addMark(t,r,n),this.replaceNode(e,o)}},{key:"filterDescendants",value:function(e){var r=[];return this.forEachDescendant(function(t,n,o){e(t,n,o)&&r.push(t)}),t.List(r)}},{key:"findDescendant",value:function(e){var t=null;return this.forEachDescendant(function(r,n,o){if(e(r,n,o))return t=r,!1}),t}},{key:"forEachDescendant",value:function(e){var t=void 0;return this.nodes.forEach(function(r,n,o){return!1===e(r,n,o)?(t=!1,!1):"text"!=r.object?t=r.forEachDescendant(e):void 0}),t}},{key:"getActiveMarksAtRange",value:function(e){if((e=e.normalize(this)).isUnset)return t.Set();if(e.isCollapsed){var r=e,n=r.startKey,o=r.startOffset;return this.getMarksAtPosition(n,o).toSet()}var a=e,i=a.startKey,s=a.endKey,u=a.startOffset,c=a.endOffset,l=this.getDescendant(i);if(i!==s){for(;i!==s&&0===c;){var f=this.getPreviousText(s);s=f.key,c=f.text.length}for(;i!==s&&u===l.text.length;)i=(l=this.getNextText(i)).key,u=0}if(i===s)return l.getActiveMarksBetweenOffsets(u,c);var h=l.getActiveMarksBetweenOffsets(u,l.text.length);if(0===h.size)return t.Set();var d=this.getDescendant(s).getActiveMarksBetweenOffsets(0,c),v=h.intersect(d);if(0===v.size)return v;for(var y=this.getNextText(i);y.key!==s;){if(0!==y.text.length&&0===(v=v.intersect(y.getActiveMarks())).size)return t.Set();y=this.getNextText(y.key)}return v}},{key:"getAncestors",value:function(e){var r=this;if(!(e=this.resolvePath(e)))return null;var n=[];return e.forEach(function(t,o){var a=e.slice(0,o),i=r.getNode(a);n.push(i)}),t.List(n)}},{key:"getBlocks",value:function(){var e=this.getBlocksAsArray();return new t.List(e)}},{key:"getBlocksAsArray",value:function(){return this.nodes.reduce(function(e,t){return"block"!=t.object?e:t.isLeafBlock()?(e.push(t),e):e.concat(t.getBlocksAsArray())},[])}},{key:"getBlocksAtRange",value:function(e){var r=this.getBlocksAtRangeAsArray(e);return new t.List(new t.OrderedSet(r))}},{key:"getBlocksAtRangeAsArray",value:function(e){if((e=e.normalize(this)).isUnset)return[];var t=e,r=t.startKey,n=t.endKey,o=this.getClosestBlock(r);if(r===n)return[o];var a=this.getClosestBlock(n),i=this.getBlocksAsArray(),s=i.indexOf(o),u=i.indexOf(a);return i.slice(s,u+1)}},{key:"getBlocksByType",value:function(e){var r=this.getBlocksByTypeAsArray(e);return new t.List(r)}},{key:"getBlocksByTypeAsArray",value:function(e){return this.nodes.reduce(function(t,r){return"block"!=r.object?t:r.isLeafBlock()&&r.type==e?(t.push(r),t):t.concat(r.getBlocksByTypeAsArray(e))},[])}},{key:"getCharacters",value:function(){return this.getTexts().flatMap(function(e){return e.characters})}},{key:"getCharactersAtRange",value:function(e){if((e=e.normalize(this)).isUnset)return t.List();var r=e,n=r.startKey,o=r.endKey,a=r.startOffset,i=r.endOffset;return n===o?this.getDescendant(o).characters.slice(a,i):this.getTextsAtRange(e).flatMap(function(e){return e.key===n?e.characters.slice(a):e.key===o?e.characters.slice(0,i):e.characters})}},{key:"getChild",value:function(e){return(e=this.resolvePath(e))&&1===e.size?this.nodes.get(e.first()):null}},{key:"getClosest",value:function(e,t){var r=this,n=this.getAncestors(e);return n&&n.findLast(function(e){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return e!==r&&t.apply(void 0,[e].concat(o))})||null}},{key:"getClosestBlock",value:function(e){return this.getClosest(e,function(e){return"block"===e.object})}},{key:"getClosestInline",value:function(e){return this.getClosest(e,function(e){return"inline"===e.object})}},{key:"getClosestVoid",value:function(e){return this.getClosest(e,function(e){return e.isVoid})}},{key:"getCommonAncestor",value:function(e,t){if(e=this.resolvePath(e),t=this.resolvePath(t),!e||!t)return null;var r=_n.relate(e,t);return this.getNode(r)}},{key:"getDecorations",value:function(e){var t=e.find("decorateNode",this);return Bn.createList(t||[])}},{key:"getDepth",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(e=this.resolvePath(e))&&this.getNode(e)?e.size-1+t:null}},{key:"getDescendant",value:function(e){if(!(e=this.resolvePath(e)))return null;var t=e.toArray(),r=this,n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;if(!r)return null;if(!r.nodes)return null;r=r.nodes.get(u)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}},{key:"getFirstInvalidDescendant",value:function(e){var t=null;return this.nodes.find(function(r){return t=r.validate(e)?r:r.getFirstInvalidDescendant(e)}),t}},{key:"getFirstText",value:function(){var e=null,t=this.nodes.find(function(t){return"text"===t.object||!!(e=t.getFirstText())});return e||t}},{key:"getFragmentAtRange",value:function(e){if((e=e.normalize(this)).isUnset)return bn.create();for(var t=e,r=t.startPath,n=t.startOffset,o=t.endPath,a=this,i=o,s=t.endOffset,u="end";i.size;){var c=i.last();a=a.splitNode(i,s),s=c+1,(i=_n.lift(i)).size||"end"!==u||(i=r,s=n,u="start")}var l=r.first()+1,f=o.first()+2,h=a.nodes.slice(l,f);return bn.create({nodes:h})}},{key:"getFurthest",value:function(e,t){var r=this,n=this.getAncestors(e);return n&&n.find(function(e){for(var n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return e!==r&&t.apply(void 0,[e].concat(o))})||null}},{key:"getFurthestAncestor",value:function(e){return(e=this.resolvePath(e))&&e.size?this.nodes.get(e.first()):null}},{key:"getFurthestBlock",value:function(e){return this.getFurthest(e,function(e){return"block"===e.object})}},{key:"getFurthestInline",value:function(e){return this.getFurthest(e,function(e){return"inline"===e.object})}},{key:"getFurthestOnlyChildAncestor",value:function(e){var t=this.getAncestors(e);return t&&t.rest().reverse().takeUntil(function(e){return e.nodes.size>1}).last()||null}},{key:"getInlines",value:function(){var e=this.getInlinesAsArray();return new t.List(e)}},{key:"getInlinesAsArray",value:function(){var e=[];return this.nodes.forEach(function(t){"text"!=t.object&&(t.isLeafInline()?e.push(t):e=e.concat(t.getInlinesAsArray()))}),e}},{key:"getInlinesAtRange",value:function(e){var r=this.getInlinesAtRangeAsArray(e);return new t.List(new t.OrderedSet(r))}},{key:"getInlinesAtRangeAsArray",value:function(e){var t=this;return(e=e.normalize(this)).isUnset?[]:this.getTextsAtRangeAsArray(e).map(function(e){return t.getClosestInline(e.key)}).filter(function(e){return e})}},{key:"getInlinesByType",value:function(e){var r=this.getInlinesByTypeAsArray(e);return new t.List(r)}},{key:"getInlinesByTypeAsArray",value:function(e){return this.nodes.reduce(function(t,r){return"text"==r.object?t:r.isLeafInline()&&r.type==e?(t.push(r),t):t.concat(r.getInlinesByTypeAsArray(e))},[])}},{key:"getInsertMarksAtRange",value:function(e){if((e=e.normalize(this)).isUnset)return t.Set();if(e.isCollapsed)return this.getMarksAtPosition(e.startKey,e.startOffset);var r=e,n=r.startKey,o=r.startOffset;return this.getDescendant(n).getMarksAtIndex(o+1)}},{key:"getKeysToPathsTable",value:function(){var e,t,r,n=(e={},t=this.key,r=[],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e);return this.nodes.forEach(function(e,t){if(n[e.key]=[t],"text"!==e.object){var r=e.getKeysToPathsTable();for(var o in r){var a=r[o];n[o]=[t].concat($(a))}}}),n}},{key:"getLastText",value:function(){var e=null,t=this.nodes.findLast(function(t){return"text"==t.object||(e=t.getLastText())});return e||t}},{key:"getMarks",value:function(){var e=this.getMarksAsArray();return new t.Set(e)}},{key:"getMarksAsArray",value:function(){var e,t=[];return this.nodes.forEach(function(e){t.push(e.getMarksAsArray())}),(e=[]).concat.apply(e,t)}},{key:"getMarksAtPosition",value:function(e,r){var n=this.getDescendant(e).getMarksAtIndex(r);if(0!==r)return n;var o=this.getClosestBlock(e);if(""===o.text)return n;var a=this.getPreviousText(e);return a?o.hasDescendant(a.key)?a.getMarksAtIndex(a.text.length):n:t.Set()}},{key:"getMarksAtRange",value:function(e){return new t.Set(this.getOrderedMarksAtRange(e))}},{key:"getMarksByType",value:function(e){var r=this.getMarksByTypeAsArray(e);return new t.Set(r)}},{key:"getMarksByTypeAsArray",value:function(e){return this.nodes.reduce(function(t,r){return"text"==r.object?t.concat(r.getMarksAsArray().filter(function(t){return t.type==e})):t.concat(r.getMarksByTypeAsArray(e))},[])}},{key:"getNextBlock",value:function(e){var t=this.assertDescendant(e),r=void 0;"block"==t.object?r=t.getLastText():r=this.getClosestBlock(e).getLastText();var n=this.getNextText(r.key);return n?this.getClosestBlock(n.key):null}},{key:"getNextNode",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;for(var t=e.size;t>0;t--){var r=e.slice(0,t),n=_n.increment(r),o=this.getNode(n);if(o)return o}return null}},{key:"getNextSibling",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=_n.increment(e);return this.getNode(t)}},{key:"getNextText",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=this.getNextNode(e);return t?t.getFirstText():null}},{key:"getNode",value:function(e){return(e=this.resolvePath(e))?e.size?this.getDescendant(e):this:null}},{key:"getOffset",value:function(e){this.assertDescendant(e);var t=this.getFurthestAncestor(e),r=this.nodes.takeUntil(function(e){return e==t}).reduce(function(e,t){return e+t.text.length},0);return this.hasChild(e)?r:r+t.getOffset(e)}},{key:"getOffsetAtRange",value:function(e){if((e=e.normalize(this)).isUnset)throw new Error("The range cannot be unset to calculcate its offset.");if(e.isExpanded)throw new Error("The range must be collapsed to calculcate its offset.");var t=e,r=t.startKey,n=t.startOffset;return this.getOffset(r)+n}},{key:"getOrderedMarks",value:function(){var e=this.getMarksAsArray();return new t.OrderedSet(e)}},{key:"getOrderedMarksAtRange",value:function(e){if((e=e.normalize(this)).isUnset)return t.OrderedSet();if(e.isCollapsed)return this.getMarksAtPosition(e.startKey,e.startOffset);var r=e,n=r.startKey,o=r.startOffset,a=r.endKey,i=r.endOffset;return this.getOrderedMarksBetweenPositions(n,o,a,i)}},{key:"getOrderedMarksBetweenPositions",value:function(e,r,n,o){if(e===n)return this.getDescendant(e).getMarksBetweenOffsets(r,o);var a=this.getTextsBetweenPositionsAsArray(e,n);return t.OrderedSet().withMutations(function(t){a.forEach(function(a){a.key===e?t.union(a.getMarksBetweenOffsets(r,a.text.length)):a.key===n?t.union(a.getMarksBetweenOffsets(0,o)):t.union(a.getMarks())})})}},{key:"getOrderedMarksByType",value:function(e){var r=this.getMarksByTypeAsArray(e);return new t.OrderedSet(r)}},{key:"getParent",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=_n.lift(e);return this.getNode(t)}},{key:"getPath",value:function(e){if(t.List.isList(e))return e;var r=this.getKeysToPathsTable()[e];return r?t.List(r):null}},{key:"getPreviousBlock",value:function(e){var t=this.assertDescendant(e),r=void 0;"block"==t.object?r=t.getFirstText():r=this.getClosestBlock(e).getFirstText();var n=this.getPreviousText(r.key);return n?this.getClosestBlock(n.key):null}},{key:"getPreviousNode",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;for(var t=e.size;t>0;t--){var r=e.slice(0,t);if(0!==r.last()){var n=_n.decrement(r),o=this.getNode(n);if(o)return o}}return null}},{key:"getPreviousSibling",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;if(0===e.last())return null;var t=_n.decrement(e);return this.getNode(t)}},{key:"getPreviousText",value:function(e){if(!(e=this.resolvePath(e)))return null;if(!e.size)return null;var t=this.getPreviousNode(e);return t?t.getLastText():null}},{key:"getSelectionIndexes",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.startKey,n=e.endKey;if(!t)return null;if(e.isUnset)return null;if(r==n){var o=this.getFurthestAncestor(r),a=o?this.nodes.indexOf(o):null;return{start:a,end:a+1}}var i=null,s=null;return this.nodes.forEach(function(e,t){return"text"==e.object?(null==i&&e.key==r&&(i=t),null==s&&e.key==n&&(s=t+1)):(null==i&&e.hasDescendant(r)&&(i=t),null==s&&e.hasDescendant(n)&&(s=t+1)),null==i||null==s}),t&&null==i&&(i=0),t&&null==s&&(s=this.nodes.size),null==i?null:{start:i,end:s}}},{key:"getText",value:function(){return this.nodes.reduce(function(e,t){return e+t.text},"")}},{key:"getTextAtOffset",value:function(e){if(0===e)return this.getFirstText();if(e===this.text.length)return this.getLastText();if(e<0||e>this.text.length)return null;var t=0;return this.getTexts().find(function(r,n,o){return(t+=r.text.length)>e})}},{key:"getTextDirection",value:function(){var e=mn(this.text);return"neutral"===e?null:e}},{key:"getTexts",value:function(){var e=this.getTextsAsArray();return new t.List(e)}},{key:"getTextsAsArray",value:function(){var e=[];return this.nodes.forEach(function(t){"text"==t.object?e.push(t):e=e.concat(t.getTextsAsArray())}),e}},{key:"getTextsAtRange",value:function(e){if((e=e.normalize(this)).isUnset)return t.List();var r=e,n=r.startKey,o=r.endKey;return new t.List(this.getTextsBetweenPositionsAsArray(n,o))}},{key:"getTextsAtRangeAsArray",value:function(e){if((e=e.normalize(this)).isUnset)return[];var t=e,r=t.startKey,n=t.endKey;return this.getTextsBetweenPositionsAsArray(r,n)}},{key:"getTextsBetweenPositionsAsArray",value:function(e,t){var r=this.getDescendant(e);if(e==t)return[r];var n=this.getDescendant(t),o=this.getTextsAsArray(),a=o.indexOf(r),i=o.indexOf(n,a);return o.slice(a,i+1)}},{key:"hasBlockChildren",value:function(){return!(!this.nodes||!this.nodes.find(function(e){return"block"===e.object}))}},{key:"hasChild",value:function(e){return!!this.getChild(e)}},{key:"hasInlineChildren",value:function(){return!(!this.nodes||!this.nodes.find(function(e){return"inline"===e.object||"text"===e.object}))}},{key:"hasDescendant",value:function(e){return!!this.getDescendant(e)}},{key:"hasNode",value:function(e){return!!this.getNode(e)}},{key:"hasVoidParent",value:function(e){return!!this.getClosestVoid(e)}},{key:"insertNode",value:function(e,t){var r=(e=this.resolvePath(e)).last(),n=_n.lift(e),o=this.assertNode(n),a=o.nodes.splice(r,0,t);return o=o.set("nodes",a),this.replaceNode(n,o)}},{key:"insertText",value:function(e,t,r,n){var o=this.assertDescendant(e);return e=this.resolvePath(e),o=o.insertText(t,r,n),this.replaceNode(e,o)}},{key:"isLeafBlock",value:function(){return"block"===this.object&&this.nodes.every(function(e){return"block"!==e.object})}},{key:"isLeafInline",value:function(){return"inline"===this.object&&this.nodes.every(function(e){return"inline"!==e.object})}},{key:"mapChildren",value:function(e){var t=this,r=this.nodes;return r.forEach(function(n,o){var a=e(n,o,t.nodes);a!==n&&(r=r.set(a.key,a))}),this.set("nodes",r)}},{key:"mapDescendants",value:function(e){var t=this,r=this.nodes;return r.forEach(function(n,o){var a=n;"text"!==a.object&&(a=a.mapDescendants(e)),(a=e(a,o,t.nodes))!==n&&(r=r.set(o,a))}),this.set("nodes",r)}},{key:"mergeNode",value:function(e){var t=this.assertNode(e);if(0===(e=this.resolvePath(e)).last())throw new Error("Unable to merge node because it has no previous sibling: "+t);var r=_n.decrement(e),n=this.assertNode(r);if(n.object!==t.object)throw new Error("Unable to merge two different kinds of nodes: "+n+" and "+t);var o="text"===n.object?n.mergeText(t):n.set("nodes",n.nodes.concat(t.nodes)),a=this;return a=(a=(a=a.removeNode(e)).removeNode(r)).insertNode(r,o)}},{key:"moveNode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.assertNode(e);e=this.resolvePath(e),t=this.resolvePath(t,r);var o=_n.lift(t);this.assertNode(o);var a=_n.crop(e,t),i=q(a,2),s=i[0],u=i[1],c=_n.compare(s,u);e.size<t.size&&-1===c&&(t=_n.decrement(t,1,s.size-1));var l=this;return l=(l=l.removeNode(e)).insertNode(t,n)}},{key:"refindNode",value:function(e,t){var r=this.getDescendant(e);return r&&r.key===t?r:this.getDescendant(t)}},{key:"refindPath",value:function(e,t){var r=this.getDescendant(e);return r&&r.key===t?e:this.getPath(t)}},{key:"regenerateKey",value:function(){var e=I.create();return this.set("key",e)}},{key:"removeMark",value:function(e,t,r,n){var o=this.assertDescendant(e);return e=this.resolvePath(e),o=o.removeMark(t,r,n),this.replaceNode(e,o)}},{key:"removeNode",value:function(e){this.assertDescendant(e);var r=(e=this.resolvePath(e)).flatMap(function(e){return t.List(["nodes",e])});return this.deleteIn(r)}},{key:"removeText",value:function(e,t,r){var n=this.assertDescendant(e);return n=n.removeText(t,r.length),this.replaceNode(e,n)}},{key:"replaceNode",value:function(e,r){if(!(e=this.resolvePath(e)))throw new Error("Unable to replace a node because it could not be found in the first place: "+e);if(!e.size)return r;this.assertNode(e);var n=e.flatMap(function(e){return t.List(["nodes",e])});return this.setIn(n,r)}},{key:"resolvePath",value:function(e,t){return"string"==typeof e?(e=this.getPath(e),null!=t&&(e=e.concat(t))):e=_n.create(e),e}},{key:"setNode",value:function(e,t){var r=this.assertNode(e);return r=r.merge(t),this.replaceNode(e,r)}},{key:"setMark",value:function(e,t,r,n,o){var a=this.assertNode(e);return a=a.updateMark(t,r,n,o),this.replaceNode(e,a)}},{key:"splitNode",value:function(e,t,r){var n=this.assertNode(e);e=this.resolvePath(e);var o=void 0,a=void 0;if("text"===n.object){var i=n.splitText(t),s=q(i,2);o=s[0],a=s[1]}else{var u=n.nodes.take(t),c=n.nodes.skip(t);o=n.set("nodes",u),a=n.set("nodes",c).regenerateKey()}r&&"text"!==n.object&&(a=a.merge(r));var l=this;return l=(l=(l=l.removeNode(e)).insertNode(e,a)).insertNode(e,o)}},{key:"normalize",value:function(e){return e.normalizeNode(this)}},{key:"validate",value:function(e){return e.validateNode(this)}},{key:"getNodeAtPath",value:function(e){return C.deprecate("0.35.0","The `Node.getNodeAtPath` method has been combined into `Node.getNode`."),this.getNode(e)}},{key:"getDescendantAtPath",value:function(e){return C.deprecate("0.35.0","The `Node.getDescendantAtPath` has been combined into `Node.getDescendant`."),this.getDescendant(e)}},{key:"getKeys",value:function(){C.deprecate("0.35.0","The `Node.getKeys` method is deprecated.");var e=this.getKeysAsArray();return new t.Set(e)}},{key:"getKeysAsArray",value:function(){C.deprecate("0.35.0","The `Node.getKeysAsArray` method is deprecated.");var e=this.getKeysToPathsTable(),t=[];for(var r in e)this.key!==r&&t.push(r);return t}},{key:"areDescendantsSorted",value:function(e,t){var r=this;C.deprecate("0.35.0","The `Node.areDescendantsSorted` method is deprecated. Use the new `PathUtils.compare` helper instead."),e=I.create(e),t=I.create(t);var n=this.getKeysAsArray().filter(function(e){return e!==r.key}),o=n.indexOf(e),a=n.indexOf(t);return-1==o||-1==a?null:o<a}},{key:"isInRange",value:function(e){C.deprecate("0.35.0","The `Node.isInRange` method is deprecated. Use the new `PathUtils.compare` helper instead.");var t=this,r=e=e.normalize(this),n=r.startKey,o=r.endKey,a=r.isCollapsed;if(t.key==n||t.key==o||t.hasDescendant(n)||t.hasDescendant(o))return!0;if(a)return!1;var i=!1;return t.getTextsAtRange(e).forEach(function(e){return t.hasDescendant(e.key)&&(i=!0),i}),i}}],[{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.isNode(t))return t;if(o(t)){var r=t.object;switch(!r&&t.kind&&(C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),r=t.kind),r){case"block":return Y.create(t);case"document":return bn.create(t);case"inline":return rn.create(t);case"text":return Cn.create(t);default:throw new Error("`Node.create` requires a `object` string.")}}throw new Error("`Node.create` only accepts objects or nodes but you passed it: "+t)}},{key:"createList",value:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(r)||Array.isArray(r))return t.List(r.map(e.create));throw new Error("`Node.createList` only accepts lists or arrays, but you passed it: "+r)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Y.isBlock(e)||rn.isInline(e))return{data:e.data,isVoid:e.isVoid,type:e.type};if("string"==typeof e)return{type:e};if(o(e)){var t={};return"type"in e&&(t.type=e.type),"data"in e&&(t.data=nn.create(e.data)),"isVoid"in e&&(t.isVoid=e.isVoid),t}throw new Error("`Node.createProperties` only accepts objects, strings, blocks or inlines, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var t=e.object;switch(!t&&e.kind&&(C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),t=e.kind),t){case"block":return Y.fromJSON(e);case"document":return bn.fromJSON(e);case"inline":return rn.fromJSON(e);case"text":return Cn.fromJSON(e);default:throw new Error("`Node.fromJSON` requires an `object` of either 'block', 'document', 'inline' or 'text', but you passed: "+e)}}},{key:"isNode",value:function(e){return!!["BLOCK","DOCUMENT","INLINE","TEXT"].find(function(t){return L(t,e)})}},{key:"isNodeList",value:function(r){return t.List.isList(r)&&r.every(function(t){return e.isNode(t)})}}]),e}();zn.fromJS=zn.fromJSON;var Ln=function(e){zn.prototype["assert"+e]=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=this["get"+e].apply(this,[t].concat(n));if(null==a)throw new Error("`Node.assert"+e+"` could not find node with path or key: "+t);return a}},Mn=!0,Rn=!1,Dn=void 0;try{for(var In,Jn=["Child","Depth","Descendant","Node","Parent","Path"][Symbol.iterator]();!(Mn=(In=Jn.next()).done);Mn=!0){Ln(In.value)}}catch(e){Rn=!0,Dn=e}finally{try{!Mn&&Jn.return&&Jn.return()}finally{if(Rn)throw Dn}}ln(zn.prototype,["getBlocksAsArray","getBlocksAtRangeAsArray","getBlocksByTypeAsArray","getDecorations","getFirstInvalidDescendant","getFirstText","getFragmentAtRange","getInlinesAsArray","getInlinesAtRangeAsArray","getInlinesByTypeAsArray","getMarksAsArray","getMarksAtPosition","getOrderedMarksBetweenPositions","getInsertMarksAtRange","getKeysToPathsTable","getLastText","getMarksByTypeAsArray","getNextBlock","getOffset","getOffsetAtRange","getPreviousBlock","getText","getTextAtOffset","getTextDirection","getTextsAsArray","getTextsBetweenPositionsAsArray","isLeafBlock","isLeafInline","normalize","validate"]),Object.getOwnPropertyNames(zn.prototype).forEach(function(e){"constructor"!==e&&(Y.prototype[e]=zn.prototype[e],rn.prototype[e]=zn.prototype[e],bn.prototype[e]=zn.prototype[e])}),Y.createChildren=zn.createList,rn.createChildren=zn.createList,bn.createChildren=zn.createList;var Vn=we(function(e,t){!function(r){var n=t,o=e&&e.exports==n&&e,a="object"==typeof Oe&&Oe;a.global!==a&&a.window!==a||(r=a);var i=/([\0-\u02FF\u0370-\u1AAF\u1B00-\u1DBF\u1E00-\u20CF\u2100-\uD7FF\uE000-\uFE1F\uFE30-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])([\u0300-\u036F\u1AB0-\u1AFF\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]+)/g,s=/([\uD800-\uDBFF])([\uDC00-\uDFFF])/g,u=function(e){for(var t="",r=(e=e.replace(i,function(e,t,r){return u(r)+t}).replace(s,"$2$1")).length;r--;)t+=e.charAt(r);return t},c={version:"0.2.0",reverse:u};if(n&&!n.nodeType)if(o)o.exports=c;else for(var l in c)c.hasOwnProperty(l)&&(n[l]=c[l]);else r.esrever=c}(Oe)}).reverse,Un=55296,Gn=57343,Wn=/\s/,Hn=/['\u2018\u2019]/,qn=/[\u0021-\u0023\u0025-\u002A\u002C-\u002F\u003A\u003B\u003F\u0040\u005B-\u005D\u005F\u007B\u007D\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/;function $n(e){return Un<=e&&e<=Gn}function Xn(e,t){if(Wn.test(e))return!1;if(Hn.test(e)){var r=t.charAt(0),n=Yn(r);if(Xn(r=t.slice(0,n),t.slice(n)))return!0}return!qn.test(e)}function Yn(e){return $n(e.charCodeAt(0))?2:1}function Zn(e){return Yn(e.charAt(0))}function Qn(e){for(var t=0,r=0,n=!1,o=void 0;o=e.charAt(r);){var a=Yn(o);if(Xn(o=e.slice(r,r+a),e.slice(r+a)))n=!0,t+=a;else{if(n)break;t+=a}r+=a}return t}var eo={getCharLength:Yn,getCharOffset:Zn,getCharOffsetBackward:function(e,t){return e=e.slice(0,t),Zn(e=Vn(e))},getCharOffsetForward:function(e,t){return Zn(e=e.slice(t))},getWordOffset:Qn,getWordOffsetBackward:function(e,t){return e=e.slice(0,t),Qn(e=Vn(e))},getWordOffsetForward:function(e,t){return Qn(e=e.slice(t))},isSurrogate:$n,isWord:Xn},to={addMarkAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!t.isCollapsed){var o=e.getFlag("normalize",n),a=e.value.document,i=t.startKey,s=t.startOffset,u=t.endKey,c=t.endOffset;a.getTextsAtRange(t).forEach(function(t){var n=t.key,a=0,l=t.text.length;n==i&&(a=s),n==u&&(l=c),n==i&&n==u&&(l=c-s),e.addMarkByKey(n,a,l,r,{normalize:o})})}},addMarksAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r.forEach(function(r){return e.addMarkAtRange(t,r,n)})},deleteAtRange:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t.isCollapsed){e.snapshotSelection();var n=e.getFlag("normalize",r),o=e.value,a=t.startKey,i=t.startOffset,s=t.endKey,u=t.endOffset,c=o.document,l=c.hasVoidParent(a),f=c.hasVoidParent(s),h=c.getClosestBlock(a),d=c.getClosestBlock(s),v=0==i&&0==u&&0==l&&a==h.getFirstText().key&&s==d.getFirstText().key;if(v&&f){var y=c.getPreviousText(s);s=y.key,u=y.text.length,f=c.hasVoidParent(s)}for(;l;){var p=c.getClosestVoid(a),g=c.getNextText(a);if(e.removeNodeByKey(p.key,{normalize:!1}),a==s)return;if(!g)return;c=e.value.document,a=g.key,i=0,l=c.hasVoidParent(a)}for(;f;){var m=c.getClosestVoid(s),k=c.getPreviousText(s);e.removeNodeByKey(m.key,{normalize:!1}),c=e.value.document,s=k.key,u=k.text.length,f=c.hasVoidParent(s)}if(a==s&&v)e.removeNodeByKey(h.key,{normalize:n});else if(a!=s){h=c.getClosestBlock(a),d=c.getClosestBlock(s);var b=c.getNode(a),A=c.getNode(s),O=b.text.length-i,w=u,x=c.getCommonAncestor(a,s),T=x.getFurthestAncestor(a),_=x.getFurthestAncestor(s),B=c.getParent(h.key),N=B.nodes.indexOf(h),F=B.nodes.indexOf(d),j=void 0;for(j=b;j.key!=T.key;){var S=c.getParent(j.key),P=S.nodes.indexOf(j);S.nodes.slice(P+1).reverse().forEach(function(t){e.removeNodeByKey(t.key,{normalize:!1})}),j=S}var E=x.nodes.indexOf(T),K=x.nodes.indexOf(_);for(x.nodes.slice(E+1,K).reverse().forEach(function(t){e.removeNodeByKey(t.key,{normalize:!1})}),j=A;j.key!=_.key;){var C=c.getParent(j.key),z=C.nodes.indexOf(j);C.nodes.slice(0,z).reverse().forEach(function(t){e.removeNodeByKey(t.key,{normalize:!1})}),j=C}if(0!=O&&e.removeTextByKey(a,i,O,{normalize:!1}),0!=w&&e.removeTextByKey(s,0,u,{normalize:!1}),h.key!=d.key){var L=(c=e.value.document).getFurthestOnlyChildAncestor(d.key);F!=N+1&&e.moveNodeByKey(d.key,B.key,N+1,{normalize:!1}),v?e.removeNodeByKey(h.key,{normalize:!1}):e.mergeNodeByKey(d.key,{normalize:!1}),L&&e.removeNodeByKey(L.key,{normalize:!1})}n&&e.normalizeNodeByKey(x.key)}else{var M=i,R=u-i;e.removeTextByKey(a,M,R,{normalize:n})}}},deleteCharBackwardAtRange:function(e,t,r){var n=e.value.document,o=t.startKey,a=t.startOffset,i=n.getClosestBlock(o),s=i.getOffset(o)+a,u=i.text,c=eo.getCharOffsetBackward(u,s);e.deleteBackwardAtRange(t,c,r)},deleteLineBackwardAtRange:function(e,t,r){var n=e.value.document,o=t.startKey,a=t.startOffset,i=n.getClosestBlock(o).getOffset(o)+a;e.deleteBackwardAtRange(t,i,r)},deleteWordBackwardAtRange:function(e,t,r){var n=e.value.document,o=t.startKey,a=t.startOffset,i=n.getClosestBlock(o),s=i.getOffset(o)+a,u=i.text,c=eo.getWordOffsetBackward(u,s);e.deleteBackwardAtRange(t,c,r)},deleteBackwardAtRange:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(0!==r){var o=e.getFlag("normalize",n),a=e.value.document,i=t,s=i.startKey,u=i.focusOffset;if(t.isExpanded)e.deleteAtRange(t,{normalize:o});else{var c=a.getClosestVoid(s);if(c)e.removeNodeByKey(c.key,{normalize:o});else{var l=a.getClosestBlock(s);if(l&&l.isEmpty&&1!==a.nodes.size)e.removeNodeByKey(l.key,{normalize:o});else if(!t.isAtStartOf(a)){var f=a.getDescendant(s);if(t.isAtStartOf(f)){var h=a.getPreviousText(f.key),d=a.getClosestBlock(h.key),v=a.getClosestVoid(h.key);if(v)return void e.removeNodeByKey(v.key,{normalize:o});if(1==r&&d!=l)return t=t.merge({anchorKey:h.key,anchorOffset:h.text.length}),void e.deleteAtRange(t,{normalize:o})}if(r<u)return t=t.merge({focusOffset:u-r,isBackward:!0}),void e.deleteAtRange(t,{normalize:o});for(var y=f,p=0,g=u;r>g;){var m=g+(y=a.getPreviousText(y.key)).text.length;if(r<=m){p=m-r;break}g=m}t=t.merge({focusKey:y.key,focusOffset:p,isBackward:!0}),e.deleteAtRange(t,{normalize:o})}}}}},deleteCharForwardAtRange:function(e,t,r){var n=e.value.document,o=t.startKey,a=t.startOffset,i=n.getClosestBlock(o),s=i.getOffset(o)+a,u=i.text,c=eo.getCharOffsetForward(u,s);e.deleteForwardAtRange(t,c,r)},deleteLineForwardAtRange:function(e,t,r){var n=e.value.document,o=t.startKey,a=t.startOffset,i=n.getClosestBlock(o),s=i.getOffset(o)+a;e.deleteForwardAtRange(t,i.text.length-s,r)},deleteWordForwardAtRange:function(e,t,r){var n=e.value.document,o=t.startKey,a=t.startOffset,i=n.getClosestBlock(o),s=i.getOffset(o)+a,u=i.text,c=eo.getWordOffsetForward(u,s);e.deleteForwardAtRange(t,c,r)},deleteForwardAtRange:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(0!==r){var o=e.getFlag("normalize",n),a=e.value.document,i=t,s=i.startKey,u=i.focusOffset;if(t.isExpanded)e.deleteAtRange(t,{normalize:o});else{var c=a.getClosestVoid(s);if(c)e.removeNodeByKey(c.key,{normalize:o});else{var l=a.getClosestBlock(s);if(l&&l.isEmpty&&1!==a.nodes.size){var f=a.getNextBlock(l.key);return e.removeNodeByKey(l.key,{normalize:o}),void(f&&f.key&&e.moveToStartOf(f))}if(!t.isAtEndOf(a)){var h=a.getDescendant(s);if(t.isAtEndOf(h)){var d=a.getNextText(h.key),v=a.getClosestBlock(d.key),y=a.getClosestVoid(d.key);if(y)return void e.removeNodeByKey(y.key,{normalize:o});if(1==r&&v!=l)return t=t.merge({focusKey:d.key,focusOffset:0}),void e.deleteAtRange(t,{normalize:o})}if(r<=h.text.length-u)return t=t.merge({focusOffset:u+r}),void e.deleteAtRange(t,{normalize:o});for(var p=h,g=u,m=h.text.length-u;r>m;){var k=m+(p=a.getNextText(p.key)).text.length;if(r<=k){g=r-m;break}m=k}t=t.merge({focusKey:p.key,focusOffset:g}),e.deleteAtRange(t,{normalize:o})}}}}},insertBlockAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r=Y.create(r);var o=e.getFlag("normalize",n);t.isExpanded&&(e.deleteAtRange(t),t=t.collapseToStart());var a=e.value.document,i=t,s=i.startKey,u=i.startOffset,c=a.getClosestBlock(s),l=a.getClosestInline(s),f=a.getParent(c.key),h=f.nodes.indexOf(c);if(c.isVoid){var d=t.isAtEndOf(c)?1:0;e.insertNodeByKey(f.key,h+d,r,{normalize:o})}else if(c.isEmpty)e.insertNodeByKey(f.key,h+1,r,{normalize:o});else if(t.isAtStartOf(c))e.insertNodeByKey(f.key,h,r,{normalize:o});else if(t.isAtEndOf(c))e.insertNodeByKey(f.key,h+1,r,{normalize:o});else{if(l&&l.isVoid){var v=t.isAtEndOf(l),y=v?a.getNextText(s):a.getPreviousText(s),p=v?t.moveToStartOf(y):t.moveToEndOf(y);s=p.startKey,u=p.startOffset}e.splitDescendantsByKey(c.key,s,u,{normalize:!1}),e.insertNodeByKey(f.key,h+1,r,{normalize:o})}o&&e.normalizeNodeByKey(f.key)},insertFragmentAtRange:function(e,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=e.getFlag("normalize",o);if(r.isExpanded&&(e.deleteAtRange(r,{normalize:!1}),r=e.value.document.getDescendant(r.startKey)?r.collapseToStart():r.collapseTo(r.endKey,0)),n.nodes.size){n=n.mapDescendants(function(e){return e.regenerateKey()});var i=r,s=i.startKey,u=i.startOffset,c=e.value.document,l=c.getDescendant(s),f=c.getClosestBlock(l.key),h=f.getFurthestAncestor(l.key),d=r.isAtStartOf(f),v=c.getParent(f.key),y=v.nodes.indexOf(f),p=n.getBlocks(),g=n.nodes.first(),m=n.nodes.last(),k=p.first(),b=p.last();if(k==b&&k.isVoid)e.insertBlockAtRange(r,k,o);else if(g.hasBlockChildren()||m.hasBlockChildren())n.nodes.reverse().forEach(function(t){e.insertBlockAtRange(r,t,o)});else{if(k!=b){var A=n.getFurthest(k.key,function(e){return 1==e.nodes.size})||k,O=v.nodes.indexOf(f);(n=n.removeNode(A.key)).nodes.forEach(function(t,r){var n=O+r+1;e.insertNodeByKey(v.key,n,t,{normalize:!1})})}if(0!=u&&e.splitDescendantsByKey(h.key,s,u,{normalize:!1}),l=(c=e.value.document).getDescendant(s),h=(f=c.getClosestBlock(s)).getFurthestAncestor(l.key),k!=b){var w=d?h:f.getNextSibling(h.key),x=w?f.nodes.skipUntil(function(e){return e.key==w.key}):t.List(),T=b.nodes.size;x.forEach(function(t,r){var n=T+r;e.moveNodeByKey(t.key,b.key,n,{normalize:!1})})}if(f.isEmpty)e.removeNodeByKey(f.key,{normalize:!1}),e.insertNodeByKey(v.key,y,k,{normalize:!1});else{var _=f.getFurthestAncestor(l.key),B=f.nodes.indexOf(_);k.nodes.forEach(function(t,r){var n=B+r+(0==u?0:1);e.insertNodeByKey(f.key,n,t,{normalize:!1})})}a&&e.normalizeNodeByKey(v.key)}}},insertInlineAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n);r=rn.create(r),t.isExpanded&&(e.deleteAtRange(t,{normalize:!1}),t=t.collapseToStart());var a=e.value.document,i=t,s=i.startKey,u=i.startOffset,c=a.getParent(s),l=a.assertDescendant(s),f=c.nodes.indexOf(l);c.isVoid||(e.splitNodeByKey(s,u,{normalize:!1}),e.insertNodeByKey(c.key,f+1,r,{normalize:!1}),o&&e.normalizeNodeByKey(c.key))},insertTextAtRange:function(e,t,r,n){var o=(arguments.length>4&&void 0!==arguments[4]?arguments[4]:{}).normalize,a=e.value.document,i=t.startKey,s=i,u=t.startOffset;if(!a.getParent(i).isVoid&&(t.isExpanded&&(e.deleteAtRange(t,{normalize:!1}),e.value.startKey!==s&&(s=e.value.startKey,u=e.value.startOffset)),void 0===o&&(o=t.isExpanded&&n&&0!==n.size),e.insertTextByKey(s,u,r,n,{normalize:!1}),o)){var c=a.getCommonAncestor(i,t.endKey),l=a.getAncestors(c.key).push(c).findLast(function(t){return e.value.document.getDescendant(t.key)}),f=l?l.key:i;e.normalizeNodeByKey(f)}},removeMarkAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!t.isCollapsed){var o=e.getFlag("normalize",n),a=e.value.document.getTextsAtRange(t),i=t.startKey,s=t.startOffset,u=t.endKey,c=t.endOffset;a.forEach(function(t){var n=t.key,a=0,l=t.text.length;n==i&&(a=s),n==u&&(l=c),n==i&&n==u&&(l=c-s),e.removeMarkByKey(n,a,l,r,{normalize:o})})}},setBlocksAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n),a=e.value.document,i=a.getBlocksAtRange(t),s=t.startKey,u=t.startOffset,c=t.endKey,l=t.endOffset,f=t.isCollapsed,h=a.hasVoidParent(s),d=a.getClosestBlock(s),v=a.getClosestBlock(c);(0==f&&0==u&&0==l&&0==h&&s==d.getFirstText().key&&c==v.getFirstText().key?i.slice(0,-1):i).forEach(function(t){e.setNodeByKey(t.key,r,{normalize:o})})},setBlockAtRange:function(){C.deprecate("slate@0.33.0","The `setBlockAtRange` method of Slate changes has been renamed to `setBlocksAtRange`."),to.setBlocksAtRange.apply(to,arguments)},setInlinesAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n);e.value.document.getInlinesAtRange(t).forEach(function(t){e.setNodeByKey(t.key,r,{normalize:o})})},setInlineAtRange:function(){C.deprecate("slate@0.33.0","The `setInlineAtRange` method of Slate changes has been renamed to `setInlinesAtRange`."),to.setInlinesAtRange.apply(to,arguments)},splitBlockAtRange:function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n),a=t,i=a.startKey,s=a.startOffset,u=a.endOffset,c=a.endKey,l=e.value.document,f=l.assertDescendant(i),h=l.getClosestBlock(f.key),d=0;h&&"block"==h.object&&d<r;)f=h,h=l.getClosestBlock(h.key),d++;if(e.splitDescendantsByKey(f.key,i,s,{normalize:o&&t.isCollapsed}),t.isExpanded){t.isBackward&&(t=t.flip());var v=e.value.document.getNextBlock(f.key);t=t.moveAnchorToStartOf(v),i===c&&(t=t.moveFocusTo(t.anchorKey,u-s)),e.deleteAtRange(t,{normalize:o})}},splitInlineAtRange:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=e.getFlag("normalize",n);t.isExpanded&&(e.deleteAtRange(t,{normalize:o}),t=t.collapseToStart());for(var a=t,i=a.startKey,s=a.startOffset,u=e.value.document,c=u.assertDescendant(i),l=u.getClosestInline(c.key),f=0;l&&"inline"==l.object&&f<r;)c=l,l=u.getClosestInline(l.key),f++;e.splitDescendantsByKey(c.key,i,s,{normalize:o})},toggleMarkAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!t.isCollapsed){r=vn.create(r);var o=e.getFlag("normalize",n);e.value.document.getActiveMarksAtRange(t).some(function(e){return e.equals(r)})?e.removeMarkAtRange(t,r,{normalize:o}):e.addMarkAtRange(t,r,{normalize:o})}},unwrapBlockAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r=zn.createProperties(r);var o=e.getFlag("normalize",n),a=e.value.document,i=a.getBlocksAtRange(t);i.map(function(e){return a.getClosest(e.key,function(e){return"block"==e.object&&((null==r.type||e.type==r.type)&&((null==r.isVoid||e.isVoid==r.isVoid)&&!(null!=r.data&&!e.data.isSuperset(r.data))))})}).filter(function(e){return e}).toOrderedSet().toList().forEach(function(t){var r=t.nodes.first(),n=t.nodes.last(),o=a.getParent(t.key),s=o.nodes.indexOf(t),u=t.nodes.filter(function(e){return i.some(function(t){return e==t||e.hasDescendant(t.key)})}),c=u.first(),l=u.last();if(r==c&&n==l)t.nodes.forEach(function(t,r){e.moveNodeByKey(t.key,o.key,s+r,{normalize:!1})}),e.removeNodeByKey(t.key,{normalize:!1});else if(n==l)t.nodes.skipUntil(function(e){return e==c}).forEach(function(t,r){e.moveNodeByKey(t.key,o.key,s+1+r,{normalize:!1})});else if(r==c)t.nodes.takeUntil(function(e){return e==l}).push(l).forEach(function(t,r){e.moveNodeByKey(t.key,o.key,s+r,{normalize:!1})});else{var f=c.getFirstText();e.splitDescendantsByKey(t.key,f.key,0,{normalize:!1}),a=e.value.document,u.forEach(function(t,r){if(0==r){var n=t;t=a.getNextBlock(t.key),e.removeNodeByKey(n.key,{normalize:!1})}e.moveNodeByKey(t.key,o.key,s+1+r,{normalize:!1})})}}),o&&e.normalizeDocument()},unwrapInlineAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r=zn.createProperties(r);var o=e.getFlag("normalize",n),a=e.value.document;a.getTextsAtRange(t).map(function(e){return a.getClosest(e.key,function(e){return"inline"==e.object&&((null==r.type||e.type==r.type)&&((null==r.isVoid||e.isVoid==r.isVoid)&&!(null!=r.data&&!e.data.isSuperset(r.data))))})}).filter(function(e){return e}).toOrderedSet().toList().forEach(function(t){var r=e.value.document.getParent(t.key),n=r.nodes.indexOf(t);t.nodes.forEach(function(t,o){e.moveNodeByKey(t.key,r.key,n+o,{normalize:!1})})}),o&&e.normalizeDocument()},wrapBlockAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};r=(r=Y.create(r)).set("nodes",r.nodes.clear());var o=e.getFlag("normalize",n),a=e.value.document,i=a.getBlocksAtRange(t),s=i.first(),u=i.last(),c=void 0,l=void 0,f=void 0;if(1===i.length?(c=a.getParent(s.key),l=i):c=a.getClosest(s.key,function(e){return!!a.getClosest(u.key,function(t){return e==t})}),null==c&&(c=a),null==l){var h=c.nodes.reduce(function(e,t,r){return(t==s||t.hasDescendant(s.key))&&(e[0]=r),(t==u||t.hasDescendant(u.key))&&(e[1]=r),e},[]);f=h[0],l=c.nodes.slice(h[0],h[1]+1)}null==f&&(f=c.nodes.indexOf(l.first())),e.insertNodeByKey(c.key,f,r,{normalize:!1}),l.forEach(function(t,n){e.moveNodeByKey(t.key,r.key,n,{normalize:!1})}),o&&e.normalizeNodeByKey(c.key)},wrapInlineAtRange:function(e,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=e.value.document,i=e.getFlag("normalize",o),s=r.startKey,u=r.startOffset,c=r.endKey,l=r.endOffset;if(r.isCollapsed){var f=a.getClosestInline(s);if(!f.isVoid)return;return e.wrapInlineByKey(f.key,n,o)}n=(n=rn.create(n)).set("nodes",n.nodes.clear());var h=a.getBlocksAtRange(r),d=a.getClosestBlock(s),v=a.getClosestBlock(c),y=a.getClosestInline(s),p=a.getClosestInline(c),g=d.getFurthestAncestor(s),m=v.getFurthestAncestor(c);y&&y==p||(e.splitDescendantsByKey(m.key,c,l,{normalize:!1}),e.splitDescendantsByKey(g.key,s,u,{normalize:!1})),d=(a=e.value.document).getDescendant(d.key),v=a.getDescendant(v.key),g=d.getFurthestAncestor(s),m=v.getFurthestAncestor(c);var k=d.nodes.indexOf(g),b=v.nodes.indexOf(m);if(y&&y==p){var A=d.getTextsAtRange(r).get(0).splitText(u)[1].splitText(l-u)[0];n=n.set("nodes",t.List([A])),to.insertInlineAtRange(e,r,n,{normalize:!1});var O=n.getFirstText().key,w={anchorKey:O,focusKey:O,anchorOffset:0,focusOffset:l-u,isFocused:!0};e.select(w)}else if(d==v){g=(d=(a=e.value.document).getClosestBlock(s)).getFurthestAncestor(s);var x=a.getNextSibling(g.key),T=d.nodes.indexOf(x),_=s==c?x:d.getFurthestAncestor(c),B=d.nodes.skipUntil(function(e){return e==x}).takeUntil(function(e){return e==_}).push(_),N=n.regenerateKey();e.insertNodeByKey(d.key,T,N,{normalize:!1}),B.forEach(function(t,r){e.moveNodeByKey(t.key,N.key,r,{normalize:!1})}),i&&e.normalizeNodeByKey(d.key)}else{var F=d.nodes.slice(k+1),j=v.nodes.slice(0,b+1),S=n.regenerateKey(),P=n.regenerateKey();e.insertNodeByKey(d.key,k+1,S,{normalize:!1}),e.insertNodeByKey(v.key,b,P,{normalize:!1}),F.forEach(function(t,r){e.moveNodeByKey(t.key,S.key,r,{normalize:!1})}),j.forEach(function(t,r){e.moveNodeByKey(t.key,P.key,r,{normalize:!1})}),i&&e.normalizeNodeByKey(d.key).normalizeNodeByKey(v.key),h.slice(1,-1).forEach(function(t){var r=n.regenerateKey();e.insertNodeByKey(t.key,0,r,{normalize:!1}),t.nodes.forEach(function(t,n){e.moveNodeByKey(t.key,r.key,n,{normalize:!1})}),i&&e.normalizeNodeByKey(t.key)})}},wrapTextAtRange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=e.getFlag("normalize",o),i=t.startKey,s=t.endKey,u=t.collapseToStart(),c=t.collapseToEnd();i==s&&(c=c.move(r.length)),e.insertTextAtRange(u,r,[],{normalize:a}),e.insertTextAtRange(c,n,[],{normalize:a})}},ro={addMarkByPath:function(e,t,r,n,o,a){o=vn.create(o);var i=e.value,s=[],u=r,c=r+n,l=0;i.document.assertNode(t).getLeaves().forEach(function(e){var r=l,n=r+e.text.length;if(l+=e.text.length,!(n<u||c<r||e.marks.has(o))){var a=Math.max(r,u),f=Math.min(n,c);s.push({type:"add_mark",value:i,path:t,offset:a,length:f-a,mark:o})}}),e.applyOperations(s),e.normalizeParentByPath(t,a)},insertFragmentByPath:function(e,t,r,n,o){n.nodes.forEach(function(n,o){e.insertNodeByPath(t,r+o,n)}),e.normalizeNodeByPath(t,o)},insertNodeByPath:function(e,t,r,n,o){var a=e.value;e.applyOperation({type:"insert_node",value:a,path:t.concat(r),node:n}),e.normalizeNodeByPath(t,o)},insertTextByPath:function(e,t,r,n,o,a){var i=e.value,s=i.document.assertNode(t);o=o||s.getMarksAtIndex(r),e.applyOperation({type:"insert_text",value:i,path:t,offset:r,text:n,marks:o}),e.normalizeParentByPath(t,a)},mergeNodeByPath:function(e,t,r){var n=e.value,o=n.document,a=o.getDescendant(t),i=o.getPreviousSibling(t);if(!i)throw new Error('Unable to merge node with path "'+t+'", because it has no previous sibling.');var s="text"==i.object?i.text.length:i.nodes.size;e.applyOperation({type:"merge_node",value:n,path:t,position:s,properties:{type:a.type,data:a.data},target:null}),e.normalizeParentByPath(t,r)},moveNodeByPath:function(e,t,r,n,o){var a=e.value;e.applyOperation({type:"move_node",value:a,path:t,newPath:r.concat(n)});var i=_n.relate(t,r);e.normalizeNodeByPath(i,o)},removeMarkByPath:function(e,t,r,n,o,a){o=vn.create(o);var i=e.value,s=[],u=r,c=r+n,l=0;i.document.assertNode(t).getLeaves().forEach(function(e){var r=l,n=r+e.text.length;if(l+=e.text.length,!(n<u||c<r)&&e.marks.has(o)){var a=Math.max(r,u),f=Math.min(n,c);s.push({type:"remove_mark",value:i,path:t,offset:a,length:f-a,mark:o})}}),e.applyOperations(s),e.normalizeParentByPath(t,a)},removeAllMarksByPath:function(e,t,r){var n=e.state.document.assertNode(t);("text"===n.object?[n]:n.getTextsAsArray()).forEach(function(t){t.getMarksAsArray().forEach(function(n){e.removeMarkByKey(t.key,0,t.text.length,n,r)})})},removeNodeByPath:function(e,t,r){var n=e.value,o=n.document.assertNode(t);e.applyOperation({type:"remove_node",value:n,path:t,node:o}),e.normalizeParentByPath(t,r)},setTextByPath:function(e,t,r,n,o){var a=e.value.document.assertNode(t).text.length;e.replaceTextByPath(t,0,a,r,n,o)},replaceTextByPath:function(e,t,r,n,o,a,i){var s=e.value.document,u=s.assertNode(t);n+r>u.text.length&&(n=u.text.length-r);var c=Bn.create({anchorPath:t,focusPath:t,anchorOffset:r,focusOffset:r+n}).normalize(s),l=s.getActiveMarksAtRange(c);e.removeTextByPath(t,r,n,{normalize:!1}),a?l&&(l=l.filter(function(e){return!a.find(function(t){return e.type===t.type})}),a=l.merge(a)):a=l||[],e.insertTextByPath(t,r,o,a,i)},removeTextByPath:function(e,t,r,n,o){var a=e.value,i=a.document,s=i.assertNode(t),u=s.getLeaves(),c=s.text,l=[],f=r,h=r+n,d=0;u.forEach(function(e){var r=d,n=r+e.text.length;if(d+=e.text.length,!(n<f||h<r)){var o=Math.max(r,f),i=Math.min(n,h),s=c.slice(o,i);l.push({type:"remove_text",value:a,path:t,offset:o,text:s,marks:e.marks})}}),e.applyOperations(l.reverse());var v=i.getClosestBlock(s.key);e.normalizeNodeByKey(v.key,o)},replaceNodeByPath:function(e,t,r,n){r=zn.create(r);var o=t.last(),a=_n.lift(t);e.removeNodeByPath(t,{normalize:!1}),e.insertNodeByPath(a,o,r,{normalize:!1}),e.normalizeParentByPath(t,n)},setMarkByPath:function(e,t,r,n,o,a,i){o=vn.create(o),a=vn.createProperties(a);var s=e.value;e.applyOperation({type:"set_mark",value:s,path:t,offset:r,length:n,mark:o,properties:a}),e.normalizeParentByPath(t,i)},setNodeByPath:function(e,t,r,n){r=zn.createProperties(r);var o=e.value,a=o.document.assertNode(t);e.applyOperation({type:"set_node",value:o,path:t,node:a,properties:r}),e.normalizeNodeByPath(t,n)},splitNodeByPath:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.target,a=void 0===o?null:o,i=e.value,s=i.document.getDescendant(t);e.applyOperation({type:"split_node",value:i,path:t,position:r,properties:{type:s.type,data:s.data},target:a}),e.normalizeParentByPath(t,n)},splitDescendantsByPath:function(e,t,r,n,o){if(t.equals(r))e.splitNodeByPath(r,n,o);else{var a=e.value.document,i=a.assertNode(t),s=a.assertNode(r),u=void 0,c=void 0;a.getAncestors(r).skipUntil(function(e){return e.key==i.key}).reverse().unshift(s).forEach(function(t){var r=null==c?null:c;c=u?t.nodes.indexOf(u)+1:n,u=t,e.splitNodeByKey(t.key,c,{normalize:!1,target:r})}),e.normalizeParentByPath(t,o)}},unwrapInlineByPath:function(e,t,r,n){var o=e.value,a=o.document,i=o.selection,s=a.assertNode(t),u=s.getFirstText(),c=s.getLastText(),l=i.moveToRangeOf(u,c);e.unwrapInlineAtRange(l,r,n)},unwrapBlockByPath:function(e,t,r,n){var o=e.value,a=o.document,i=o.selection,s=a.assertNode(t),u=s.getFirstText(),c=s.getLastText(),l=i.moveToRangeOf(u,c);e.unwrapBlockAtRange(l,r,n)},unwrapNodeByPath:function(e,t,r){var n=e.value.document;n.assertNode(t);var o=_n.lift(t),a=n.assertNode(o),i=t.last(),s=o.last(),u=_n.lift(o),c=0===i,l=i===a.nodes.size-1;if(1===a.nodes.size)e.moveNodeByPath(t,u,s+1,{normalize:!1}),e.removeNodeByPath(o,r);else if(c)e.moveNodeByPath(t,u,s,r);else if(l)e.moveNodeByPath(t,u,s+1,r);else{e.splitNodeByPath(o,i,{normalize:!1});var f=_n.increment(t,1,o.size-1);f=f.set(f.size-1,0),e.moveNodeByPath(f,u,s+1,{normalize:!1}),e.normalizeNodeByPath(u,r)}},wrapBlockByPath:function(e,t,r,n){r=(r=Y.create(r)).set("nodes",r.nodes.clear());var o=_n.lift(t),a=t.last(),i=_n.increment(t);e.insertNodeByPath(o,a,r,{normalize:!1}),e.moveNodeByPath(i,t,0,n)},wrapInlineByPath:function(e,t,r,n){r=(r=rn.create(r)).set("nodes",r.nodes.clear());var o=_n.lift(t),a=t.last(),i=_n.increment(t);e.insertNodeByPath(o,a,r,{normalize:!1}),e.moveNodeByPath(i,t,0,n)},wrapNodeByPath:function(e,t,r){"block"!=(r=zn.create(r)).object?"inline"!=r.object||e.wrapInlineByPath(t,r):e.wrapBlockByPath(t,r)}},no=function(e){ro[e+"ByKey"]=function(t,r){for(var n=arguments.length,o=Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];var i=t.value.document.assertPath(r);t[e+"ByPath"].apply(t,[i].concat(o))}},oo=!0,ao=!1,io=void 0;try{for(var so,uo=["addMark","insertFragment","insertNode","insertText","mergeNode","removeMark","removeAllMarks","removeNode","setText","replaceText","removeText","replaceNode","setMark","setNode","splitNode","unwrapInline","unwrapBlock","unwrapNode","wrapBlock","wrapInline","wrapNode"][Symbol.iterator]();!(oo=(so=uo.next()).done);oo=!0){no(so.value)}}catch(e){ao=!0,io=e}finally{try{!oo&&uo.return&&uo.return()}finally{if(ao)throw io}}ro.moveNodeByKey=function(e,t,r){for(var n=arguments.length,o=Array(n>3?n-3:0),a=3;a<n;a++)o[a-3]=arguments[a];var i=e.value.document,s=i.assertPath(t),u=i.assertPath(r);e.moveNodeByPath.apply(e,[s,u].concat(o))},ro.splitDescendantsByKey=function(e,t,r){for(var n=arguments.length,o=Array(n>3?n-3:0),a=3;a<n;a++)o[a-3]=arguments[a];var i=e.value.document,s=i.assertPath(t),u=i.assertPath(r);e.splitDescendantsByPath.apply(e,[s,u].concat(o))};var co=function(){this.__data__=new Vt,this.size=0};var lo=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var fo=function(e){return this.__data__.get(e)};var ho=function(e){return this.__data__.has(e)},vo=200;var yo=function(e,t){var r=this.__data__;if(r instanceof Vt){var n=r.__data__;if(!Ut||n.length<vo-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Qt(n)}return r.set(e,t),this.size=r.size,this};function po(e){var t=this.__data__=new Vt(e);this.size=t.size}po.prototype.clear=co,po.prototype.delete=lo,po.prototype.get=fo,po.prototype.has=ho,po.prototype.set=yo;var go=po,mo="__lodash_hash_undefined__";var ko=function(e){return this.__data__.set(e,mo),this};var bo=function(e){return this.__data__.has(e)};function Ao(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new Qt;++t<r;)this.add(e[t])}Ao.prototype.add=Ao.prototype.push=ko,Ao.prototype.has=bo;var Oo=Ao;var wo=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var xo=function(e,t){return e.has(t)},To=1,_o=2;var Bo=function(e,t,r,n,o,a){var i=r&To,s=e.length,u=t.length;if(s!=u&&!(i&&u>s))return!1;var c=a.get(e);if(c&&a.get(t))return c==t;var l=-1,f=!0,h=r&_o?new Oo:void 0;for(a.set(e,t),a.set(t,e);++l<s;){var d=e[l],v=t[l];if(n)var y=i?n(v,d,l,t,e,a):n(d,v,l,e,t,a);if(void 0!==y){if(y)continue;f=!1;break}if(h){if(!wo(t,function(e,t){if(!xo(h,t)&&(d===e||o(d,e,r,n,a)))return h.push(t)})){f=!1;break}}else if(d!==v&&!o(d,v,r,n,a)){f=!1;break}}return a.delete(e),a.delete(t),f},No=ze.Uint8Array;var Fo=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r};var jo=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},So=1,Po=2,Eo="[object Boolean]",Ko="[object Date]",Co="[object Error]",zo="[object Map]",Lo="[object Number]",Mo="[object RegExp]",Ro="[object Set]",Do="[object String]",Io="[object Symbol]",Jo="[object ArrayBuffer]",Vo="[object DataView]",Uo=Le?Le.prototype:void 0,Go=Uo?Uo.valueOf:void 0;var Wo=function(e,t,r,n,o,a,i){switch(r){case Vo:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Jo:return!(e.byteLength!=t.byteLength||!a(new No(e),new No(t)));case Eo:case Ko:case Lo:return Ct(+e,+t);case Co:return e.name==t.name&&e.message==t.message;case Mo:case Do:return e==t+"";case zo:var s=Fo;case Ro:var u=n&So;if(s||(s=jo),e.size!=t.size&&!u)return!1;var c=i.get(e);if(c)return c==t;n|=Po,i.set(e,t);var l=Bo(s(e),s(t),n,o,a,i);return i.delete(e),l;case Io:if(Go)return Go.call(e)==Go.call(t)}return!1};var Ho=function(e,t,r){var n=t(e);return Ee(e)?n:Rr(n,r(e))};var qo=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,a=[];++r<n;){var i=e[r];t(i,r,e)&&(a[o++]=i)}return a};var $o=function(){return[]},Xo=Object.prototype.propertyIsEnumerable,Yo=Object.getOwnPropertySymbols,Zo=Yo?function(e){return null==e?[]:(e=Object(e),qo(Yo(e),function(t){return Xo.call(e,t)}))}:$o;var Qo=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var ea=function(){return!1},ta=we(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?ze.Buffer:void 0,a=(o?o.isBuffer:void 0)||ea;e.exports=a}),ra={};ra["[object Float32Array]"]=ra["[object Float64Array]"]=ra["[object Int8Array]"]=ra["[object Int16Array]"]=ra["[object Int32Array]"]=ra["[object Uint8Array]"]=ra["[object Uint8ClampedArray]"]=ra["[object Uint16Array]"]=ra["[object Uint32Array]"]=!0,ra["[object Arguments]"]=ra["[object Array]"]=ra["[object ArrayBuffer]"]=ra["[object Boolean]"]=ra["[object DataView]"]=ra["[object Date]"]=ra["[object Error]"]=ra["[object Function]"]=ra["[object Map]"]=ra["[object Number]"]=ra["[object Object]"]=ra["[object RegExp]"]=ra["[object Set]"]=ra["[object String]"]=ra["[object WeakMap]"]=!1;var na=function(e){return $e(e)&&Cr(e.length)&&!!ra[qe(e)]};var oa=function(e){return function(t){return e(t)}},aa=we(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r&&Ke.process,a=function(){try{return o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=a}),ia=aa&&aa.isTypedArray,sa=ia?oa(ia):na,ua=Object.prototype.hasOwnProperty;var ca=function(e,t){var r=Ee(e),n=!r&&Er(e),o=!r&&!n&&ta(e),a=!r&&!n&&!o&&sa(e),i=r||n||o||a,s=i?Qo(e.length,String):[],u=s.length;for(var c in e)!t&&!ua.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||xr(c,u))||s.push(c);return s},la=Object.prototype;var fa=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||la)};var ha=function(e,t){return function(r){return e(t(r))}},da=ha(Object.keys,Object),va=Object.prototype.hasOwnProperty;var ya=function(e){if(!fa(e))return da(e);var t=[];for(var r in Object(e))va.call(e,r)&&"constructor"!=r&&t.push(r);return t};var pa=function(e){return null!=e&&Cr(e.length)&&!st(e)};var ga=function(e){return pa(e)?ca(e):ya(e)};var ma=function(e){return Ho(e,ga,Zo)},ka=1,ba=Object.prototype.hasOwnProperty;var Aa=function(e,t,r,n,o,a){var i=r&ka,s=ma(e),u=s.length;if(u!=ma(t).length&&!i)return!1;for(var c=u;c--;){var l=s[c];if(!(i?l in t:ba.call(t,l)))return!1}var f=a.get(e);if(f&&a.get(t))return f==t;var h=!0;a.set(e,t),a.set(t,e);for(var d=i;++c<u;){var v=e[l=s[c]],y=t[l];if(n)var p=i?n(y,v,l,t,e,a):n(v,y,l,e,t,a);if(!(void 0===p?v===y||o(v,y,r,n,a):p)){h=!1;break}d||(d="constructor"==l)}if(h&&!d){var g=e.constructor,m=t.constructor;g!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m)&&(h=!1)}return a.delete(e),a.delete(t),h},Oa=At(ze,"DataView"),wa=At(ze,"Promise"),xa=At(ze,"Set"),Ta=At(ze,"WeakMap"),_a=ht(Oa),Ba=ht(Ut),Na=ht(wa),Fa=ht(xa),ja=ht(Ta),Sa=qe;(Oa&&"[object DataView]"!=Sa(new Oa(new ArrayBuffer(1)))||Ut&&"[object Map]"!=Sa(new Ut)||wa&&"[object Promise]"!=Sa(wa.resolve())||xa&&"[object Set]"!=Sa(new xa)||Ta&&"[object WeakMap]"!=Sa(new Ta))&&(Sa=function(e){var t=qe(e),r="[object Object]"==t?e.constructor:void 0,n=r?ht(r):"";if(n)switch(n){case _a:return"[object DataView]";case Ba:return"[object Map]";case Na:return"[object Promise]";case Fa:return"[object Set]";case ja:return"[object WeakMap]"}return t});var Pa=Sa,Ea=1,Ka="[object Arguments]",Ca="[object Array]",za="[object Object]",La=Object.prototype.hasOwnProperty;var Ma=function(e,t,r,n,o,a){var i=Ee(e),s=Ee(t),u=i?Ca:Pa(e),c=s?Ca:Pa(t),l=(u=u==Ka?za:u)==za,f=(c=c==Ka?za:c)==za,h=u==c;if(h&&ta(e)){if(!ta(t))return!1;i=!0,l=!1}if(h&&!l)return a||(a=new go),i||sa(e)?Bo(e,t,r,n,o,a):Wo(e,t,u,r,n,o,a);if(!(r&Ea)){var d=l&&La.call(e,"__wrapped__"),v=f&&La.call(t,"__wrapped__");if(d||v){var y=d?e.value():e,p=v?t.value():t;return a||(a=new go),o(y,p,r,n,a)}}return!!h&&(a||(a=new go),Aa(e,t,r,n,o,a))};var Ra=function e(t,r,n,o,a){return t===r||(null==t||null==r||!$e(t)&&!$e(r)?t!=t&&r!=r:Ma(t,r,n,o,e,a))};var Da=function(e,t){return Ra(e,t)},Ia=Pe("slate:history"),Ja={redos:new t.Stack,undos:new t.Stack},Va=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"save",value:function(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this,a=o,i=a.undos,s=a.redos,u=n.merge,c=n.skip,l=i.peek(),f=l&&l.last();if(null==c&&(c=!!(r=f)&&"set_selection"==e.type&&"set_selection"==r.type),c)return o;if(null==u&&(u=function(e,t){return!!t&&("set_selection"==e.type&&"set_selection"==t.type||"insert_text"==e.type&&"insert_text"==t.type&&e.offset==t.offset+t.text.length&&Da(e.path,t.path)||"remove_text"==e.type&&"remove_text"==t.type&&e.offset+e.text.length==t.offset&&Da(e.path,t.path))}(e,f)),Ia("save",{operation:e,merge:u}),u&&l){var h=l.push(e);i=(i=i.pop()).push(h)}else{var d=new t.List([e]);i=i.push(d)}return i.size>100&&(i=i.take(100)),s=s.clear(),o=o.set("undos",i).set("redos",s)}},{key:"toJSON",value:function(){return{object:this.object,redos:this.redos.toJSON(),undos:this.undos.toJSON()}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"history"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isHistory(e))return e;if(o(e))return r.fromJSON(e);throw new Error("`History.create` only accepts objects or histories, but you passed it: "+e)}},{key:"createOperationsList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e))return e;if(Array.isArray(e))return new t.List(e);throw new Error("`History.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=e.redos,o=void 0===n?[]:n,a=e.undos,i=void 0===a?[]:a;return new r({redos:new t.Stack(o.map(this.createOperationsList)),undos:new t.Stack(i.map(this.createOperationsList))})}}]),r}(t.Record(Ja));Va.fromJS=Va.fromJSON,Va.isHistory=L.bind(null,"HISTORY"),Va.prototype[z.HISTORY]=!0;var Ua="child_object_invalid",Ga="child_required",Wa="child_type_invalid",Ha="child_unknown",qa="first_child_object_invalid",$a="first_child_type_invalid",Xa="last_child_object_invalid",Ya="last_child_type_invalid",Za="node_data_invalid",Qa="node_is_void_invalid",ei="node_mark_invalid",ti="node_object_invalid",ri="node_text_invalid",ni="node_type_invalid",oi="parent_object_invalid",ai="parent_type_invalid",ii=function(e){function t(){return V(this,t),H(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return W(t,e),U(t,[{key:"getPluginsWith",value:function(e){return this.plugins.filter(function(t){return null!=t[e]})}},{key:"find",value:function(e){for(var t=this.getPluginsWith(e),r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=!0,i=!1,s=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,f=l[e].apply(l,n);if(null!=f)return f}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}},{key:"map",value:function(e){for(var t=this.getPluginsWith(e),r=[],n=arguments.length,o=Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];var i=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value,h=f[e].apply(f,o);null!=h&&r.push(h)}}catch(e){s=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(s)throw u}}return r}},{key:"run",value:function(e){for(var t=this.getPluginsWith(e),r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a=!0,i=!1,s=void 0;try{for(var u,c=t[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(null!=l[e].apply(l,n))return}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}},{key:"render",value:function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return this.getPluginsWith(e).reduceRight(function(r,o){if(!o[e])return r;var a=o[e].apply(o,[t].concat(n));return null==a?r:(t.children=a,a)},void 0===t.children?null:t.children)}},{key:"object",get:function(){return"stack"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).plugins;return new t({plugins:void 0===e?[]:e})}},{key:"isStack",value:function(e){return!(!e||!e[z.STACK])}}]),t}(t.Record({plugins:[]}));ii.prototype[z.STACK]=!0,ln(ii.prototype,["getPluginsWith"]);var si=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};V(this,t);var n=H(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));for(var o in n.code=e,r)n[o]=r[o];return Error.captureStackTrace?Error.captureStackTrace(n,n.constructor):n.stack=(new Error).stack,n}return W(t,e),t}(Error),ui=Pe("slate:schema"),ci=[{match:{object:"document"},nodes:[{match:{object:"block"}}]},{match:{object:"block",first:{object:"block"}},nodes:[{match:{object:"block"}}]},{match:{object:"block",first:[{object:"inline"},{object:"text"}]},nodes:[{match:[{object:"inline"},{object:"text"}]}]},{match:{object:"inline"},nodes:[{match:[{object:"inline"},{object:"text"}]}]},{match:[{object:"block"},{object:"inline"}],nodes:[{min:1}],normalize:function(e,t){var r=t.code,n=t.node;"child_required"===r&&e.insertNodeByKey(n.key,0,Cn.create(),{normalize:!1})}},{match:{object:"inline",isVoid:!1,nodes:[{match:{object:"text"}}]},text:/[\w\W]+/},{match:{object:"block"},first:[{object:"block"},{object:"text"}],last:[{object:"block"},{object:"text"}],normalize:function(e,t){var r=t.code,n=t.node,o=Cn.create(),a=void 0;if("first_child_object_invalid"===r)a=0;else{if("last_child_object_invalid"!==r)return;a=n.nodes.size}e.insertNodeByKey(n.key,a,o,{normalize:!1})}},{match:{object:"inline"},first:[{object:"block"},{object:"text"}],last:[{object:"block"},{object:"text"}],previous:[{object:"block"},{object:"text"}],next:[{object:"block"},{object:"text"}],normalize:function(e,t){var r=t.code,n=t.node,o=t.index,a=Cn.create(),i=void 0;if("first_child_object_invalid"===r)i=0;else if("last_child_object_invalid"===r)i=n.nodes.size;else if("previous_sibling_object_invalid"===r)i=o;else{if("next_sibling_object_invalid"!==r)return;i=o+1}e.insertNodeByKey(n.key,i,a,{normalize:!1})}},{match:{object:"text"},next:[{object:"block"},{object:"inline"}],normalize:function(e,t){var r=t.code,n=t.next;"next_sibling_object_invalid"===r&&e.mergeNodeByKey(n.key,{normalize:!1})}}],li={stack:ii.create(),rules:[]},fi=function(e){function t(){return V(this,t),H(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return W(t,e),U(t,[{key:"validateNode",value:function(e){var t=this.rules.filter(function(t){return hi(e,t.match)}),r=di(e,t,this.rules,{every:!0});if(r)return new si(r.code,r)}},{key:"testNode",value:function(e){return!this.validateNode(e)}},{key:"assertNode",value:function(e){var t=this.validateNode(e);if(t)throw t}},{key:"normalizeNode",value:function(e){var t=this.stack.find("normalizeNode",e);if(t)return t;if("text"!=e.object){var r=this.validateNode(e);if(r)return function(e){ui("normalizing",{error:r});var t=r.rule,n=e.operations.size;t.normalize&&t.normalize(e,r),e.operations.size===n&&function(e,t){switch(t.code){case Ua:case Wa:case Ha:case qa:case $a:case Xa:case Ya:var r=t.child,n=t.node;return"text"==r.object&&"block"==n.object&&1==n.nodes.size?e.removeNodeByKey(n.key):e.removeNodeByKey(r.key);case Ga:case ri:case oi:case ai:var o=t.node;return"document"==o.object?o.nodes.forEach(function(t){return e.removeNodeByKey(t.key)}):e.removeNodeByKey(o.key);case Za:var a=t.node,i=t.key;return void 0===a.data.get(i)&&"document"!=a.object?e.removeNodeByKey(a.key):e.setNodeByKey(a.key,{data:a.data.delete(i)});case Qa:var s=t.node;return e.setNodeByKey(s.key,{isVoid:!s.isVoid});case ei:var u=t.node,c=t.mark;return u.getTexts().forEach(function(t){return e.removeMarkByKey(t.key,0,t.text.length,c)});default:var l=t.node;e.removeNodeByKey(l.key)}}(e,r)}}}},{key:"toJSON",value:function(){return{object:this.object,rules:this.rules}}},{key:"toJS",value:function(){return this.toJSON()}},{key:"object",get:function(){return"schema"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.isSchema(e))return e;if(o(e))return t.fromJSON(e);throw new Error("`Schema.create` only accepts objects or schemas, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(t.isSchema(e))return e;var r=e.plugins?e.plugins:[{schema:e}],n=[].concat(ci),o=!0,a=!1,i=void 0;try{for(var s,u=r[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value.schema,l=void 0===c?{}:c,f=l.blocks,h=void 0===f?{}:f,d=l.inlines,v=void 0===d?{}:d;for(var y in l.rules&&(n=n.concat(l.rules)),l.document&&n.push(G({match:[{object:"document"}]},l.document)),h)n.push(G({match:[{object:"block",type:y}]},h[y]));for(var p in v)n.push(G({match:[{object:"inline",type:p}]},v[p]))}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}return new t({stack:ii.create({plugins:r}),rules:n})}},{key:"isSchema",value:function(e){return!(!e||!e[z.SCHEMA])}}]),t}(t.Record(li));function hi(e,t){return!di(e,t)}function di(e,t,r){var n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).every,o=void 0!==n&&n;if(Array.isArray(t)){var a=t.length?t:[{}],i=void 0,s=!0,u=!1,c=void 0;try{for(var l,f=a[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=di(e,l.value,r);if(i=i||h,o&&h)return h;if(!o&&!h)return}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}return i}return function(e,t){t.objects&&C.warn("The `objects` schema validation rule was changed. Please use the new `match` syntax with `object`.");if(null==t.object)return;if(t.object===e.object)return;return gi(ti,{rule:t,node:e})}(e,t)||function(e,t){t.types&&C.warn("The `types` schema validation rule was changed. Please use the new `match` syntax with `type`.");if(null==t.type)return;if(t.type===e.type)return;return gi(ni,{rule:t,node:e})}(e,t)||function(e,t){if(null==t.isVoid)return;if(t.isVoid===e.isVoid)return;return gi(Qa,{rule:t,node:e})}(e,t)||function(e,t){if(null==t.data)return;if(null==e.data)return;for(var r in t.data){var n=t.data[r],o=e.data&&e.data.get(r),a="function"==typeof n?n(o):n===o;if(!a)return gi(Za,{rule:t,node:e,key:r,value:o})}}(e,t)||function(e,t){if(null==t.marks)return;var r=e.getMarks().toArray(),n=function(r){var n=t.marks.some(function(e){return e.type===r.type});return n?"continue":{v:gi(ei,{rule:t,node:e,mark:r})}},o=!0,a=!1,i=void 0;try{for(var s,u=r[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,l=n(c);switch(l){case"continue":continue;default:if("object"===(void 0===l?"undefined":J(l)))return l.v}}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}}(e,t)||function(e,t){if(null==t.text)return;var r=e.text;if(t.text.test(r))return;return gi(ri,{rule:t,node:e,text:r})}(e,t)||function(e,t){if(null==t.first)return;var r=e.nodes.first();if(!r)return;var n=di(r,t.first);if(!n)return;return n.rule=t,n.node=e,n.child=r,n.code=n.code.replace("node_","first_child_"),n}(e,t)||function(e,t){if(null==t.last)return;var r=e.nodes.last();if(!r)return;var n=di(r,t.last);if(!n)return;return n.rule=t,n.node=e,n.child=r,n.code=n.code.replace("node_","last_child_"),n}(e,t)||function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null==e.nodes)return;var n=e.nodes.toArray(),o=null!=t.nodes?t.nodes.slice():[],a=void 0,i=void 0,s=void 0,u=void 0,c=void 0,l=void 0,f=void 0,h=void 0;function d(){return a=null==a?null:0,u=o.shift(),i=u&&u.min,c=u&&u.max,!!u}function v(){return s=null==s?0:s+1,a=null==a?0:a+1,f=l,l=n[s],h=n[s+1],null!=c&&a==c&&d(),!!l}function y(){a-=1,s-=1}null!=t.nodes&&d();for(;v();){var p=vi(e,l,r)||yi(e,l,f,s,r)||pi(e,l,h,s,r);if(p)return p;if(null!=t.nodes){if(!u)return gi(Ha,{rule:t,node:e,child:l,index:s});if(u&&(u.objects&&C.warn("The `objects` schema validation rule was changed. Please use the new `match` syntax with `object`."),u.types&&C.warn("The `types` schema validation rule was changed. Please use the new `match` syntax with `type`.")),u.match){var g=di(l,u.match);if(g&&a>=i&&d()){y();continue}if(g)return g.rule=t,g.node=e,g.child=l,g.index=s,g.code=g.code.replace("node_","child_"),g}}}if(null!=t.nodes)for(;null!=i;){if(a<i)return gi(Ga,{rule:t,node:e,index:s});d()}}(e,t,r)}function vi(e,t,r){var n=!0,o=!1,a=void 0;try{for(var i,s=r[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;if(null!=u.parent&&hi(t,u.match)){var c=di(e,u.parent);if(c)return c.rule=u,c.parent=e,c.node=t,c.code=c.code.replace("node_","parent_"),c}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}function yi(e,t,r,n,o){if(r){var a=!0,i=!1,s=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(null!=l.previous&&hi(t,l.match)){var f=di(r,l.previous);if(f)return f.rule=l,f.node=e,f.child=t,f.index=n,f.previous=r,f.code=f.code.replace("node_","previous_sibling_"),f}}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}}function pi(e,t,r,n,o){if(r){var a=!0,i=!1,s=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;if(null!=l.next&&hi(t,l.match)){var f=di(r,l.next);if(f)return f.rule=l,f.node=e,f.child=t,f.index=n,f.next=r,f.code=f.code.replace("node_","next_sibling_"),f}}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}}}function gi(e,t){return G({code:e},t)}fi.fromJS=fi.fromJSON,fi.prototype[z.SCHEMA]=!0;var mi={data:new t.Map,decorations:null,document:bn.create(),history:Va.create(),schema:fi.create(),selection:Bn.create()},ki=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"change",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new cu(G({},e,{value:this}))}},{key:"addMark",value:function(e,t,r,n){var o=this,a=o.document;return a=a.addMark(e,t,r,n),o=this.set("document",a)}},{key:"insertNode",value:function(e,t){var r=this,n=r.document;return n=n.insertNode(e,t),r=(r=r.set("document",n)).mapRanges(function(e){return e.merge({anchorPath:null,focusPath:null})})}},{key:"insertText",value:function(e,t,r,n){var o=this,a=o.document;a=a.insertText(e,t,r,n),o=o.set("document",a);var i=a.assertNode(e);return o=(o=(o=o.clearAtomicRanges(i.key,t)).mapRanges(function(e){var n=e.anchorKey,o=e.anchorOffset,a=e.isBackward,s=e.isAtomic;return n!==i.key||!(o>t)&&(o!==t||s&&a)?e:e.moveAnchor(r.length)})).mapRanges(function(e){var n=e.focusKey,o=e.focusOffset,a=e.isBackward,s=e.isAtomic;return n===i.key&&(o>t||o==t&&(!s||a))?e.moveFocus(r.length):e})}},{key:"mergeNode",value:function(e){var t=this,r=t.document,n=r.mergeNode(e);e=r.resolvePath(e);var o=_n.decrement(e),a=r.getNode(o),i=r.getNode(e);return t=(t=t.set("document",n)).mapRanges(function(e){if("text"===i.object){var t=a.text.length;e.anchorKey===i.key&&(e=e.moveAnchorTo(a.key,t+e.anchorOffset)),e.focusKey===i.key&&(e=e.moveFocusTo(a.key,t+e.focusOffset))}return e=e.merge({anchorPath:null,focusPath:null})})}},{key:"moveNode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this,o=n.document;return o=o.moveNode(e,t,r),n=(n=n.set("document",o)).mapRanges(function(e){return e.merge({anchorPath:null,focusPath:null})})}},{key:"removeMark",value:function(e,t,r,n){var o=this,a=o.document;return a=a.removeMark(e,t,r,n),o=this.set("document",a)}},{key:"removeNode",value:function(e){var t=this,r=t.document,n=r.assertNode(e),o="text"==n.object?n:n.getFirstText()||n,a="text"==n.object?n:n.getLastText()||n,i=r.getPreviousText(o.key),s=r.getNextText(a.key);return r=r.removeNode(e),t=(t=t.set("document",r)).mapRanges(function(e){var t=e,r=t.startKey,o=t.endKey;return n.hasNode(r)&&(e=i?e.moveStartTo(i.key,i.text.length):s?e.moveStartTo(s.key,0):e.deselect()),n.hasNode(o)&&(e=i?e.moveEndTo(i.key,i.text.length):s?e.moveEndTo(s.key,0):e.deselect()),e=e.merge({anchorPath:null,focusPath:null})})}},{key:"removeText",value:function(e,t,r){var n=this,o=n.document;o=o.removeText(e,t,r),n=n.set("document",o);var a=o.assertNode(e),i=r.length,s=t+i;return n=(n=(n=n.clearAtomicRanges(a.key,t,t+i)).mapRanges(function(e){return e.anchorKey===a.key?e.anchorOffset>=s?e.moveAnchor(-i):e.anchorOffset>t?e.moveAnchorTo(e.anchorKey,t):e:e})).mapRanges(function(e){return e.focusKey===a.key?e.focusOffset>=s?e.moveFocus(-i):e.focusOffset>t?e.moveFocusTo(e.focusKey,t):e:e})}},{key:"setNode",value:function(e,t){var r=this,n=r.document;return n=n.setNode(e,t),r=r.set("document",n)}},{key:"setMark",value:function(e,t,r,n,o){var a=this,i=a.document;return i=i.setMark(e,t,r,n,o),a=a.set("document",i)}},{key:"setSelection",value:function(e){var t=this,r=t,n=r.document,o=r.selection;return o=(o=o.merge(e)).normalize(n),t=t.set("selection",o)}},{key:"splitNode",value:function(e,t,r){var n=this,o=n.document,a=o.splitNode(e,t,r),i=o.assertNode(e);return n=(n=n.set("document",a)).mapRanges(function(e){var r=a.getNextText(i.key),n=e,o=n.startKey,s=n.startOffset,u=n.endKey,c=n.endOffset;return i.key===o&&t<=s&&(e=e.moveStartTo(r.key,s-t)),i.key===u&&t<=c&&(e=e.moveEndTo(r.key,c-t)),e=e.merge({anchorPath:null,focusPath:null})})}},{key:"mapRanges",value:function(e){var t=this,r=t,n=r.document,o=r.selection,a=r.decorations;if(o){var i=o.isSet?e(o):o;i||(i=o.deselect()),i!==o&&(i=i.normalize(n)),t=t.set("selection",i)}if(a){var s=a.map(function(t){var r=t.isSet?e(t):t;return r&&r!==t&&(r=r.normalize(n)),r});s=(s=s.filter(function(e){return!!e})).size?s:null,t=t.set("decorations",s)}return t}},{key:"clearAtomicRanges",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.mapRanges(function(n){var o=n.isAtomic,a=n.startKey,i=n.startOffset,s=n.endKey,u=n.endOffset;return o?a!==e?n:i<t&&(s!==e||u>t)?null:null!=r&&i<r&&(s!==e||u>r)?null:n:n})}},{key:"toJSON",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={object:this.object,document:this.document.toJSON(e)};return e.preserveData&&(t.data=this.data.toJSON(e)),e.preserveDecorations&&(t.decorations=this.decorations?this.decorations.toArray().map(function(t){return t.toJSON(e)}):null),e.preserveHistory&&(t.history=this.history.toJSON(e)),e.preserveSelection&&(t.selection=this.selection.toJSON(e)),e.preserveSchema&&(t.schema=this.schema.toJSON(e)),t}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"value"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}},{key:"hasUndos",get:function(){return this.history.undos.size>0}},{key:"hasRedos",get:function(){return this.history.redos.size>0}},{key:"isBlurred",get:function(){return this.selection.isBlurred}},{key:"isFocused",get:function(){return this.selection.isFocused}},{key:"isCollapsed",get:function(){return this.selection.isCollapsed}},{key:"isExpanded",get:function(){return this.selection.isExpanded}},{key:"isBackward",get:function(){return this.selection.isBackward}},{key:"isForward",get:function(){return this.selection.isForward}},{key:"startKey",get:function(){return this.selection.startKey}},{key:"endKey",get:function(){return this.selection.endKey}},{key:"startPath",get:function(){return this.selection.startPath}},{key:"endPath",get:function(){return this.selection.endPath}},{key:"startOffset",get:function(){return this.selection.startOffset}},{key:"endOffset",get:function(){return this.selection.endOffset}},{key:"anchorKey",get:function(){return this.selection.anchorKey}},{key:"focusKey",get:function(){return this.selection.focusKey}},{key:"anchorPath",get:function(){return this.selection.anchorPath}},{key:"focusPath",get:function(){return this.selection.focusPath}},{key:"anchorOffset",get:function(){return this.selection.anchorOffset}},{key:"focusOffset",get:function(){return this.selection.focusOffset}},{key:"startBlock",get:function(){return this.startKey&&this.document.getClosestBlock(this.startKey)}},{key:"endBlock",get:function(){return this.endKey&&this.document.getClosestBlock(this.endKey)}},{key:"anchorBlock",get:function(){return this.anchorKey&&this.document.getClosestBlock(this.anchorKey)}},{key:"focusBlock",get:function(){return this.focusKey&&this.document.getClosestBlock(this.focusKey)}},{key:"startInline",get:function(){return this.startKey&&this.document.getClosestInline(this.startKey)}},{key:"endInline",get:function(){return this.endKey&&this.document.getClosestInline(this.endKey)}},{key:"anchorInline",get:function(){return this.anchorKey&&this.document.getClosestInline(this.anchorKey)}},{key:"focusInline",get:function(){return this.focusKey&&this.document.getClosestInline(this.focusKey)}},{key:"startText",get:function(){return this.startKey&&this.document.getDescendant(this.startKey)}},{key:"endText",get:function(){return this.endKey&&this.document.getDescendant(this.endKey)}},{key:"anchorText",get:function(){return this.anchorKey&&this.document.getDescendant(this.anchorKey)}},{key:"focusText",get:function(){return this.focusKey&&this.document.getDescendant(this.focusKey)}},{key:"nextBlock",get:function(){return this.endKey&&this.document.getNextBlock(this.endKey)}},{key:"previousBlock",get:function(){return this.startKey&&this.document.getPreviousBlock(this.startKey)}},{key:"nextInline",get:function(){return this.endKey&&this.document.getNextInline(this.endKey)}},{key:"previousInline",get:function(){return this.startKey&&this.document.getPreviousInline(this.startKey)}},{key:"nextText",get:function(){return this.endKey&&this.document.getNextText(this.endKey)}},{key:"previousText",get:function(){return this.startKey&&this.document.getPreviousText(this.startKey)}},{key:"characters",get:function(){return this.selection.isUnset?new t.List:this.document.getCharactersAtRange(this.selection)}},{key:"marks",get:function(){return this.selection.isUnset?new t.Set:this.selection.marks||this.document.getMarksAtRange(this.selection)}},{key:"activeMarks",get:function(){return this.selection.isUnset?new t.Set:this.selection.marks||this.document.getActiveMarksAtRange(this.selection)}},{key:"blocks",get:function(){return this.selection.isUnset?new t.List:this.document.getBlocksAtRange(this.selection)}},{key:"fragment",get:function(){return this.selection.isUnset?bn.create():this.document.getFragmentAtRange(this.selection)}},{key:"inlines",get:function(){return this.selection.isUnset?new t.List:this.document.getInlinesAtRange(this.selection)}},{key:"texts",get:function(){return this.selection.isUnset?new t.List:this.document.getTextsAtRange(this.selection)}},{key:"isEmpty",get:function(){return!!this.isCollapsed||(0==this.endOffset||0==this.startOffset)&&this.fragment.isEmpty}},{key:"isInVoid",get:function(){return!this.isExpanded&&this.document.hasVoidParent(this.startKey)}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r.isValue(e))return e;if(o(e))return r.fromJSON(e,t);throw new Error("`Value.create` only accepts objects or values, but you passed it: "+e)}},{key:"createProperties",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isValue(e))return{data:e.data,decorations:e.decorations,schema:e.schema};if(o(e)){var t={};return"data"in e&&(t.data=nn.create(e.data)),"decorations"in e&&(t.decorations=Bn.createList(e.decorations)),"schema"in e&&(t.schema=fi.create(e.schema)),t}throw new Error("`Value.createProperties` only accepts objects or values, but you passed it: "+e)}},{key:"fromJSON",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.document,a=void 0===o?{}:o,i=e.selection,s=void 0===i?{}:i,u=e.schema,c=void 0===u?{}:u,l=e.history,f=void 0===l?{}:l,h=new t.Map;if(a=bn.fromJSON(a),s=Bn.fromJSON(s),c=fi.fromJSON(c),f=Va.fromJSON(f),n.plugins){var d=!0,v=!1,y=void 0;try{for(var p,g=n.plugins[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var m=p.value;m.data&&(h=h.merge(m.data))}}catch(e){v=!0,y=e}finally{try{!d&&g.return&&g.return()}finally{if(v)throw y}}}if("data"in e&&(h=h.merge(e.data)),s.isUnset){var k=a.getFirstText();k&&(s=s.collapseToStartOf(k))}var b=new r({data:h,document:a,selection:s=s.normalize(a),schema:c,history:f});return!1!==n.normalize&&(b=b.change({save:!1}).normalize().value),b}},{key:"isValue",value:function(e){return!(!e||!e[z.VALUE])}}]),r}(t.Record(mi));ki.fromJS=ki.fromJSON,ki.prototype[z.VALUE]=!0;var bi={add_mark:["value","path","offset","length","mark"],insert_node:["value","path","node"],insert_text:["value","path","offset","text","marks"],merge_node:["value","path","position","properties","target"],move_node:["value","path","newPath"],remove_mark:["value","path","offset","length","mark"],remove_node:["value","path","node"],remove_text:["value","path","offset","text","marks"],set_mark:["value","path","offset","length","mark","properties"],set_node:["value","path","node","properties"],set_selection:["value","selection","properties"],set_value:["value","properties"],split_node:["value","path","position","properties","target"]},Ai={length:void 0,mark:void 0,marks:void 0,newPath:void 0,node:void 0,offset:void 0,path:void 0,position:void 0,properties:void 0,selection:void 0,target:void 0,text:void 0,type:void 0,value:void 0},Oi=function(e){function r(){return V(this,r),H(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return W(r,e),U(r,[{key:"toJSON",value:function(){var e=this.object,t=this.type,r={object:e,type:t},n=bi[t],o=!0,a=!1,i=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,l=this[c];if("document"!=c&&("selection"!=c&&"value"!=c&&("node"!=c||"insert_node"==t))){if("mark"!=c&&"marks"!=c&&"node"!=c||(l=l.toJSON()),"properties"==c&&"merge_node"==t){var f={};"data"in l&&(f.data=l.data.toJS()),"type"in l&&(f.type=l.type),l=f}if("properties"==c&&"set_mark"==t){var h={};"data"in l&&(h.data=l.data.toJS()),"type"in l&&(h.type=l.type),l=h}if("properties"==c&&"set_node"==t){var d={};"data"in l&&(d.data=l.data.toJS()),"isVoid"in l&&(d.isVoid=l.isVoid),"type"in l&&(d.type=l.type),l=d}if("properties"==c&&"set_selection"==t){var v={};"anchorOffset"in l&&(v.anchorOffset=l.anchorOffset),"anchorPath"in l&&(v.anchorPath=l.anchorPath&&l.anchorPath.toJSON()),"focusOffset"in l&&(v.focusOffset=l.focusOffset),"focusPath"in l&&(v.focusPath=l.focusPath&&l.focusPath.toJSON()),"isBackward"in l&&(v.isBackward=l.isBackward),"isFocused"in l&&(v.isFocused=l.isFocused),"marks"in l&&(v.marks=l.marks&&l.marks.toJSON()),l=v}if("properties"==c&&"set_value"==t){var y={};"data"in l&&(y.data=l.data.toJS()),"decorations"in l&&(y.decorations=l.decorations.toJS()),"schema"in l&&(y.schema=l.schema.toJS()),l=y}if("properties"==c&&"split_node"==t){var p={};"data"in l&&(p.data=l.data.toJS()),"type"in l&&(p.type=l.type),l=p}r[c]=l}}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}return r}},{key:"toJS",value:function(e){return this.toJSON(e)}},{key:"object",get:function(){return"operation"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r.isOperation(e))return e;if(o(e))return r.fromJSON(e);throw new Error("`Operation.create` only accepts objects or operations, but you passed it: "+e)}},{key:"createList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.List.isList(e)||Array.isArray(e))return new t.List(e.map(r.create));throw new Error("`Operation.createList` only accepts arrays or lists, but you passed it: "+e)}},{key:"fromJSON",value:function(e){if(r.isOperation(e))return e;var t=e.type,n=bi[t],o={type:t};if(!n)throw new Error('`Operation.fromJSON` was passed an unrecognized operation type: "'+t+'"');var a=!0,i=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value,f=e[l];if(void 0===f){if("document"==l)continue;if("selection"==l)continue;if("value"==l)continue;if("node"==l&&"insert_node"!=t)continue;throw new Error('`Operation.fromJSON` was passed a "'+t+'" operation without the required "'+l+'" attribute.')}"path"!==l&&"newPath"!==l||(f=_n.create(f)),"mark"===l&&(f=vn.create(f)),"marks"===l&&null!=f&&(f=vn.createSet(f)),"node"===l&&(f=zn.create(f)),"selection"===l&&(f=Bn.create(f)),"value"===l&&(f=ki.create(f)),"properties"===l&&"merge_node"===t&&(f=zn.createProperties(f)),"properties"===l&&"set_mark"===t&&(f=vn.createProperties(f)),"properties"===l&&"set_node"===t&&(f=zn.createProperties(f)),"properties"===l&&"set_selection"===t&&(f=Bn.createProperties(f)),"properties"===l&&"set_value"===t&&(f=ki.createProperties(f)),"properties"===l&&"split_node"===t&&(f=zn.createProperties(f)),o[l]=f}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}return new r(o)}},{key:"isOperation",value:function(e){return!(!e||!e[z.OPERATION])}},{key:"isOperationList",value:function(e){return t.List.isList(e)&&e.every(function(e){return r.isOperation(e)})}}]),r}(t.Record(Ai));Oi.fromJS=Oi.fromJSON,Oi.prototype[z.OPERATION]=!0;var wi=Pe("slate:operation:invert");function xi(e){var t=(e=Oi.create(e)).type;switch(wi(t,e),t){case"insert_node":return e.set("type","remove_node");case"remove_node":return e.set("type","insert_node");case"move_node":var r=e,n=r.newPath,o=r.path,a=n,i=o,s=o.size-1,u=n.size-1;return o.size<a.size&&o.slice(0,s).every(function(e,t){return e==a.get(t)})&&o.last()<a.get(s)&&(a=a.slice(0,s).concat(a.get(s)-1).concat(a.slice(s+1,a.size))),n.size<i.size&&n.slice(0,u).every(function(e,t){return e==i.get(t)})&&n.last()<=i.get(u)&&(i=i.slice(0,u).concat(i.get(u)+1).concat(i.slice(u+1,i.size))),e.set("path",a).set("newPath",i);case"merge_node":var c=e.path,l=_n.decrement(c);return e.set("type","split_node").set("path",l);case"split_node":var f=e.path,h=_n.increment(f);return e.set("type","merge_node").set("path",h);case"set_node":var d=e,v=d.properties,y=d.node,p=y.merge(v),g=en(y,Object.keys(v));return e.set("node",p).set("properties",g);case"insert_text":return e.set("type","remove_text");case"remove_text":return e.set("type","insert_text");case"add_mark":return e.set("type","remove_mark");case"remove_mark":return e.set("type","add_mark");case"set_mark":var m=e,k=m.properties,b=m.mark,A=b.merge(k),O=en(b,Object.keys(k));return e.set("mark",A).set("properties",O);case"set_selection":var w=e,x=w.properties,T=w.selection,_=T.merge(x),B=en(T,Object.keys(x));return e.set("selection",_).set("properties",B);case"set_value":var N=e,F=N.properties,j=N.value,S=j.merge(F),P=en(j,Object.keys(F));return e.set("value",S).set("properties",P);default:throw new Error('Unknown operation type: "'+t+'".')}}var Ti=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e};var _i=function(e,t,r,n){var o=!r;r||(r={});for(var a=-1,i=t.length;++a<i;){var s=t[a],u=n?n(r[s],e[s],s,r,e):void 0;void 0===u&&(u=e[s]),o?kr(r,s,u):Ar(r,s,u)}return r};var Bi=function(e,t){return e&&_i(t,ga(t),e)};var Ni=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},Fi=Object.prototype.hasOwnProperty;var ji=function(e){if(!tt(e))return Ni(e);var t=fa(e),r=[];for(var n in e)("constructor"!=n||!t&&Fi.call(e,n))&&r.push(n);return r};var Si=function(e){return pa(e)?ca(e,!0):ji(e)};var Pi=function(e,t){return e&&_i(t,Si(t),e)},Ei=we(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?ze.Buffer:void 0,a=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}});var Ki=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var Ci=function(e,t){return _i(e,Zo(e),t)},zi=ha(Object.getPrototypeOf,Object),Li=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Rr(t,Zo(e)),e=zi(e);return t}:$o;var Mi=function(e,t){return _i(e,Li(e),t)};var Ri=function(e){return Ho(e,Si,Li)},Di=Object.prototype.hasOwnProperty;var Ii=function(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&Di.call(e,"index")&&(r.index=e.index,r.input=e.input),r};var Ji=function(e){var t=new e.constructor(e.byteLength);return new No(t).set(new No(e)),t};var Vi=function(e,t){var r=t?Ji(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)};var Ui=function(e,t){return e.set(t[0],t[1]),e};var Gi=function(e,t,r,n){var o=-1,a=null==e?0:e.length;for(n&&a&&(r=e[++o]);++o<a;)r=t(r,e[o],o,e);return r},Wi=1;var Hi=function(e,t,r){var n=t?r(Fo(e),Wi):Fo(e);return Gi(n,Ui,new e.constructor)},qi=/\w*$/;var $i=function(e){var t=new e.constructor(e.source,qi.exec(e));return t.lastIndex=e.lastIndex,t};var Xi=function(e,t){return e.add(t),e},Yi=1;var Zi=function(e,t,r){var n=t?r(jo(e),Yi):jo(e);return Gi(n,Xi,new e.constructor)},Qi=Le?Le.prototype:void 0,es=Qi?Qi.valueOf:void 0;var ts=function(e){return es?Object(es.call(e)):{}};var rs=function(e,t){var r=t?Ji(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},ns="[object Boolean]",os="[object Date]",as="[object Map]",is="[object Number]",ss="[object RegExp]",us="[object Set]",cs="[object String]",ls="[object Symbol]",fs="[object ArrayBuffer]",hs="[object DataView]",ds="[object Float32Array]",vs="[object Float64Array]",ys="[object Int8Array]",ps="[object Int16Array]",gs="[object Int32Array]",ms="[object Uint8Array]",ks="[object Uint8ClampedArray]",bs="[object Uint16Array]",As="[object Uint32Array]";var Os=function(e,t,r,n){var o=e.constructor;switch(t){case fs:return Ji(e);case ns:case os:return new o(+e);case hs:return Vi(e,n);case ds:case vs:case ys:case ps:case gs:case ms:case ks:case bs:case As:return rs(e,n);case as:return Hi(e,n,r);case is:case cs:return new o(e);case ss:return $i(e);case us:return Zi(e,n,r);case ls:return ts(e)}},ws=Object.create,xs=function(){function e(){}return function(t){if(!tt(t))return{};if(ws)return ws(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var Ts=function(e){return"function"!=typeof e.constructor||fa(e)?{}:xs(zi(e))},_s=1,Bs=2,Ns=4,Fs="[object Arguments]",js="[object Function]",Ss="[object GeneratorFunction]",Ps="[object Object]",Es={};Es[Fs]=Es["[object Array]"]=Es["[object ArrayBuffer]"]=Es["[object DataView]"]=Es["[object Boolean]"]=Es["[object Date]"]=Es["[object Float32Array]"]=Es["[object Float64Array]"]=Es["[object Int8Array]"]=Es["[object Int16Array]"]=Es["[object Int32Array]"]=Es["[object Map]"]=Es["[object Number]"]=Es[Ps]=Es["[object RegExp]"]=Es["[object Set]"]=Es["[object String]"]=Es["[object Symbol]"]=Es["[object Uint8Array]"]=Es["[object Uint8ClampedArray]"]=Es["[object Uint16Array]"]=Es["[object Uint32Array]"]=!0,Es["[object Error]"]=Es[js]=Es["[object WeakMap]"]=!1;var Ks=function e(t,r,n,o,a,i){var s,u=r&_s,c=r&Bs,l=r&Ns;if(n&&(s=a?n(t,o,a,i):n(t)),void 0!==s)return s;if(!tt(t))return t;var f=Ee(t);if(f){if(s=Ii(t),!u)return Ki(t,s)}else{var h=Pa(t),d=h==js||h==Ss;if(ta(t))return Ei(t,u);if(h==Ps||h==Fs||d&&!a){if(s=c||d?{}:Ts(t),!u)return c?Mi(t,Pi(s,t)):Ci(t,Bi(s,t))}else{if(!Es[h])return a?t:{};s=Os(t,h,e,u)}}i||(i=new go);var v=i.get(t);if(v)return v;i.set(t,s);var y=l?c?Ri:ma:c?keysIn:ga,p=f?void 0:y(t);return Ti(p||t,function(o,a){p&&(o=t[a=o]),Ar(s,a,e(o,r,n,a,t,i))}),s};var Cs=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var zs=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(o);++n<o;)a[n]=e[n+t];return a};var Ls=function(e,t){return t.length<2?e:gr(e,zs(t,0,-1))};var Ms=function(e,t){return t=vr(t,e),null==(e=Ls(e,t))||delete e[pr(Cs(t))]},Rs="[object Object]",Ds=Function.prototype,Is=Object.prototype,Js=Ds.toString,Vs=Is.hasOwnProperty,Us=Js.call(Object);var Gs=function(e){if(!$e(e)||qe(e)!=Rs)return!1;var t=zi(e);if(null===t)return!0;var r=Vs.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Js.call(r)==Us};var Ws=function(e){return Gs(e)?void 0:e},Hs=Qr(function(e,t){var r={};if(null==e)return r;var n=!1;t=ur(t,function(t){return t=vr(t,e),n||(n=t.length>1),t}),_i(e,Ri(e),r),n&&(r=Ks(r,7,Ws));for(var o=t.length;o--;)Ms(r,t[o]);return r}),qs={redo:function(e){var t=e.value,r=t.history;if(r){var n=r,o=n.undos,a=n.redos,i=a.peek();i&&(a=a.pop(),o=o.push(i),i.forEach(function(t){var r=t,n=r.type,o=r.properties;"set_selection"==n&&(t=t.set("properties",Hs(o,"isFocused"))),e.applyOperation(t,{save:!1})}),t=e.value,r=r.set("undos",o).set("redos",a),t=t.set("history",r),e.value=t)}},undo:function(e){var t=e.value,r=t.history;if(r){var n=r,o=n.undos,a=n.redos,i=o.peek();i&&(o=o.pop(),a=a.push(i),i.slice().reverse().map(xi).forEach(function(t){var r=t,n=r.type,o=r.properties;"set_selection"==n&&(t=t.set("properties",Hs(o,"isFocused"))),e.applyOperation(t,{save:!1})}),t=e.value,r=r.set("undos",o).set("redos",a),t=t.set("history",r),e.value=t)}}},$s=Object.prototype.hasOwnProperty,Xs=Object.prototype.toString;var Ys=function(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(e.toString==Xs)switch(e.toString()){case"[object File]":case"[object Map]":case"[object Set]":return 0===e.size;case"[object Object]":for(var t in e)if($s.call(e,t))return!1;return!0}return!1},Zs={select:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=Bn.createProperties(r);var o=n.snapshot,a=void 0!==o&&o,i=e.value,s=i.document,u=i.selection,c={},l=u.merge(r).normalize(s);for(var f in r=en(l,Object.keys(r)))!0!==a&&t.is(r[f],u[f])||(c[f]=r[f]);u.marks&&!c.marks&&(c.hasOwnProperty("anchorKey")||c.hasOwnProperty("anchorOffset")||c.hasOwnProperty("focusKey")||c.hasOwnProperty("focusOffset"))&&(c.marks=null),Ys(c)||e.applyOperation({type:"set_selection",value:i,properties:c,selection:u.toJSON()},a?{skip:!1,merge:!1}:{})},selectAll:function(e){var t=e.value,r=t.document,n=t.selection.moveToRangeOf(r);e.select(n)},snapshotSelection:function(e){var t=e.value.selection;e.select(t,{snapshot:!0})},moveAnchorCharBackward:function(e){var t=e.value,r=t.document,n=t.selection,o=t.anchorText,a=t.anchorBlock,i=n.anchorOffset,s=r.getPreviousText(o.key),u=r.hasVoidParent(o.key),c=s&&r.hasVoidParent(s.key);!u&&i>0?e.moveAnchor(-1):s&&(e.moveAnchorToEndOf(s),u||c||!a.hasNode(s.key)||e.moveAnchor(-1))},moveAnchorCharForward:function(e){var t=e.value,r=t.document,n=t.selection,o=t.anchorText,a=t.anchorBlock,i=n.anchorOffset,s=r.getNextText(o.key),u=r.hasVoidParent(o.key),c=s&&r.hasVoidParent(s.key);!u&&i<o.text.length?e.moveAnchor(1):s&&(e.moveAnchorToStartOf(s),u||c||!a.hasNode(s.key)||e.moveAnchor(1))},moveFocusCharBackward:function(e){var t=e.value,r=t.document,n=t.selection,o=t.focusText,a=t.focusBlock,i=n.focusOffset,s=r.getPreviousText(o.key),u=r.hasVoidParent(o.key),c=s&&r.hasVoidParent(s.key);!u&&i>0?e.moveFocus(-1):s&&(e.moveFocusToEndOf(s),u||c||!a.hasNode(s.key)||e.moveFocus(-1))},moveFocusCharForward:function(e){var t=e.value,r=t.document,n=t.selection,o=t.focusText,a=t.focusBlock,i=n.focusOffset,s=r.getNextText(o.key),u=r.hasVoidParent(o.key),c=s&&r.hasVoidParent(s.key);!u&&i<o.text.length?e.moveFocus(1):s&&(e.moveFocusToStartOf(s),u||c||!a.hasNode(s.key)||e.moveFocus(1))}};["Forward","Backward"].forEach(function(e){var t="moveAnchorChar"+e,r="moveFocusChar"+e;Zs["moveChar"+e]=function(e){e[t]()[r]()},Zs["moveStartChar"+e]=function(e){e.value.isBackward?e[r]():e[t]()},Zs["moveEndChar"+e]=function(e){e.value.isBackward?e[t]():e[r]()},Zs["extendChar"+e]=function(t){t["moveFocusChar"+e]()},Zs["collapseChar"+e]=function(t){t["Forward"==e?"collapseToEnd":"collapseToStart"]()["moveChar"+e]()}});[["collapseLineBackward","collapseToStartOfBlock"],["collapseLineForward","collapseToEndOfBlock"],["extendLineBackward","extendToStartOfBlock"],["extendLineForward","extendToEndOfBlock"]].forEach(function(e){var t=q(e,2),r=t[0],n=t[1];Zs[r]=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];e[n].apply(e,[e].concat(r))}});["blur","collapseTo","collapseToAnchor","collapseToEnd","collapseToEndOf","collapseToFocus","collapseToStart","collapseToStartOf","extend","extendTo","extendToEndOf","extendToStartOf","flip","focus","move","moveAnchor","moveAnchorOffsetTo","moveAnchorTo","moveAnchorToEndOf","moveAnchorToStartOf","moveEnd","moveEndOffsetTo","moveEndTo","moveFocus","moveFocusOffsetTo","moveFocusTo","moveFocusToEndOf","moveFocusToStartOf","moveOffsetsTo","moveStart","moveStartOffsetTo","moveStartTo","moveTo","moveToEnd","moveToEndOf","moveToRangeOf","moveToStart","moveToStartOf","deselect"].forEach(function(e){Zs[e]=function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];var a="deselect"!=e,i=t.value,s=i.document,u=i.selection,c=u[e].apply(u,n);a&&(c=c.normalize(s)),t.select(c)}});var Qs=["Next","Previous"],eu=["Block","Inline","Text"];["moveTo","moveAnchorTo","moveFocusTo","moveStartTo","moveEndTo","collapseTo","extendTo"].forEach(function(e){var t=["Start","End"];"moveTo"==e&&t.push("Range"),t.forEach(function(t){var r=""+e+t+"Of";eu.forEach(function(e){var t="Text"==e?"getNode":"getClosest"+e;Zs[""+r+e]=function(e){var n=e.value,o=n.document,a=n.selection,i=o[t](a.startKey);i&&e[r](i)},Qs.forEach(function(n){var o="get"+n+e,a="Next"==n?"startKey":"endKey";Zs[""+r+n+e]=function(e){var n=e.value,i=n.document,s=n.selection,u=i[t](s[a]);if(u){var c=i[o](u.key);c&&e[r](c)}}})})})});var tu={setValue:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=ki.createProperties(t);var n=e.value;e.applyOperation({type:"set_value",properties:t,value:n},r)}},ru={};function nu(e,t,r){if("text"!=t.object){for(var n=t.getFirstInvalidDescendant(r),o=e.value.document.getPath(t.key);t&&n;)nu(e,n,r),(t=e.value.document.refindNode(o,t.key))?(o=e.value.document.refindPath(o,t.key),n=t.getFirstInvalidDescendant(r)):(o=[],n=null);t&&ou(e,t,r)}else ou(e,t,r)}function ou(e,t,r){var n=r.stack.plugins.length+r.rules.length+1,o=0;!function e(t,a){var i=a.normalize(r);if(i){var s=t.value.document.getPath(a.key);if(i(t),a=t.value.document.refindNode(s,a.key)){if(s=t.value.document.refindPath(s,a.key),++o>n)throw new Error("A schema rule could not be normalized after sufficient iterations. This is usually due to a `rule.normalize` or `plugin.normalizeNode` function of a schema being incorrectly written, causing an infinite loop.");e(t,a)}}}(e,t)}ru.normalize=function(e,t){e.normalizeDocument(t)},ru.normalizeDocument=function(e,t){var r=e.value.document;e.normalizeNodeByKey(r.key,t)},ru.normalizeNodeByKey=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.getFlag("normalize",r)){var n=e.value,o=n.document,a=n.schema;nu(e,o.assertNode(t),a),e.normalizeAncestorsByKey(t)}},ru.normalizeAncestorsByKey=function(e,t){var r=e.value,n=r.document,o=r.schema,a=n.getAncestors(t);a&&a.forEach(function(t){e.value.document.getDescendant(t.key)&&ou(e,t,o)})},ru.normalizeParentByKey=function(e,t,r){var n=e.value.document.getParent(t);e.normalizeNodeByKey(n.key,r)},ru.normalizeNodeByPath=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.getFlag("normalize",r)){var n=e.value,o=n.document,a=n.schema,i=o.assertNode(t);nu(e,i,a);var s=(o=e.value.document).getAncestors(t);s&&s.forEach(function(t){e.value.document.getDescendant(t.key)&&ou(e,t,a)})}},ru.normalizeParentByPath=function(e,t,r){var n=_n.lift(t);e.normalizeNodeByPath(n,r)};var au=G({},gn,to,ro,qs,Zs,tu,ru),iu=Pe("slate:operation:apply");function su(e,t){var r=(t=Oi.create(t)).type;switch(iu(r,t),r){case"add_mark":var n=t,o=n.path,a=n.offset,i=n.length,s=n.mark;return e.addMark(o,a,i,s);case"insert_node":var u=t,c=u.path,l=u.node;return e.insertNode(c,l);case"insert_text":var f=t,h=f.path,d=f.offset,v=f.text,y=f.marks;return e.insertText(h,d,v,y);case"merge_node":var p=t.path;return e.mergeNode(p);case"move_node":var g=t,m=g.path,k=g.newPath;return e.moveNode(m,k);case"remove_mark":var b=t,A=b.path,O=b.offset,w=b.length,x=b.mark;return e.removeMark(A,O,w,x);case"remove_node":var T=t.path;return e.removeNode(T);case"remove_text":var _=t,B=_.path,N=_.offset,F=_.text;return e.removeText(B,N,F);case"set_mark":var j=t,S=j.path,P=j.offset,E=j.length,K=j.mark,C=j.properties;return e.setMark(S,P,E,K,C);case"set_node":var z=t,L=z.path,M=z.properties;return e.setNode(L,M);case"set_selection":var R=t.properties;return e.setSelection(R);case"set_value":var D=t.properties;return e.merge(D);case"split_node":var I=t,J=I.path,V=I.position,U=I.properties;return e.splitNode(J,V,U);default:throw new Error('Unknown operation type: "'+r+'".')}}var uu=Pe("slate:change"),cu=function(){function e(r){V(this,e);var n=r.value;this.value=n,this.operations=new t.List,this.flags=G({normalize:!0},en(r,["merge","save","normalize"]))}return U(e,[{key:"applyOperation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.operations,n=this.flags,a=this.value,i=a.history;o(e)&&(e=G({},e,{value:a})),e=Oi.create(e);var s=t=G({},n,t),u=s.merge,c=void 0===u?0!=r.size||null:u,l=s.save,f=void 0===l||l,h=s.skip,d=void 0===h?null:h;return uu("apply",{operation:e,save:f,merge:c}),a=su(a,e),i&&f&&(i=i.save(e,{merge:c,skip:d}),a=a.set("history",i)),this.value=a,this.operations=r.push(e),this}},{key:"applyOperations",value:function(e,t){var r=this;return e.forEach(function(e){return r.applyOperation(e,t)}),this}},{key:"call",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.apply(void 0,[this].concat(r)),this}},{key:"withoutNormalization",value:function(e){var t=this.flags.normalize;return this.setOperationFlag("normalize",!1),e(this),this.setOperationFlag("normalize",t),this.normalizeDocument(),this}},{key:"setOperationFlag",value:function(e,t){return this.flags[e]=t,this}},{key:"getFlag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0!==t[e]?t[e]:this.flags[e]}},{key:"unsetOperationFlag",value:function(e){return delete this.flags[e],this}},{key:"object",get:function(){return"change"}},{key:"kind",get:function(){return C.deprecate("slate@0.32.0","The `kind` property of Slate objects has been renamed to `object`."),this.object}}]),e}();cu.isChange=L.bind(null,"CHANGE"),cu.prototype[z.CHANGE]=!0,Object.keys(au).forEach(function(e){cu.prototype[e]=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return uu(e,{args:r}),this.call.apply(this,[au[e]].concat(r)),this}});var lu={apply:su,invert:xi};function fu(e){return C.deprecate("0.35.0","The `setKeyGenerator()` util is deprecrated. Use the `KeyUtils.setGenerator()` helper instead."),I.setGenerator(e)}function hu(){return C.deprecate("0.35.0","The `resetKeyGenerator()` util is deprecrated. Use the `KeyUtils.resetGenerator()` helper instead."),I.resetGenerator()}var du={Block:Y,Changes:au,Character:Sn,Data:nn,Document:bn,History:Va,Inline:rn,KeyUtils:I,Leaf:En,Mark:vn,Node:zn,Operation:Oi,Operations:lu,PathUtils:_n,Range:Bn,resetKeyGenerator:hu,resetMemoization:fn,Schema:fi,setKeyGenerator:fu,Stack:ii,Text:Cn,TextUtils:eo,useMemoization:hn,Value:ki};e.Block=Y,e.Change=cu,e.Changes=au,e.Character=Sn,e.Data=nn,e.Document=bn,e.History=Va,e.Inline=rn,e.KeyUtils=I,e.Leaf=En,e.Mark=vn,e.Node=zn,e.Operation=Oi,e.Operations=lu,e.PathUtils=_n,e.Range=Bn,e.resetKeyGenerator=hu,e.resetMemoization=fn,e.Schema=fi,e.setKeyGenerator=fu,e.Stack=ii,e.Text=Cn,e.TextUtils=eo,e.useMemoization=hn,e.Value=ki,e.default=du,Object.defineProperty(e,"__esModule",{value:!0})});
